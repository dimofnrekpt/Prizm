import { trigger, transition, style, animate } from '@angular/animations';
import { Component, EventEmitter, HostBinding, Input, Output, QueryList, ViewChildren } from '@angular/core';
import { PrizmStepperSelectorItemDirective } from './stepper-selector-item.directive';
import { PrizmAbstractTestId } from '@prizm-ui/core';
import { CommonModule } from '@angular/common';
import { PrizmIconComponent } from '../icon/icon.component';
import { prizmEmptyQueryList } from '@prizm-ui/helpers';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
export class PrizmStepperSelectorComponent extends PrizmAbstractTestId {
    constructor() {
        super(...arguments);
        this.steps = [];
        this.selectStep = new EventEmitter();
        this.selectorItems = prizmEmptyQueryList();
        this.testId_ = 'ui_stepper--selector';
    }
    clickOnStep(index) {
        if (this.currentStep !== index) {
            this.selectStep.next(index);
        }
    }
    onKeyDown(event, stepNumber) {
        if (['ArrowRight', 'ArrowLeft', 'ArrowUp', 'ArrowDown'].includes(event.key)) {
            event.preventDefault();
            const selectorItems = this.selectorItems.toArray();
            switch (event.key) {
                case 'ArrowRight':
                case 'ArrowUp': {
                    for (let i = 0; i < selectorItems.length; i++) {
                        const item = selectorItems[i];
                        if (item.stepIndex > stepNumber && item.disabled === false) {
                            item.focus();
                            break;
                        }
                    }
                    break;
                }
                case 'ArrowDown':
                case 'ArrowLeft': {
                    for (let i = selectorItems.length - 1; i >= 0; i--) {
                        const item = selectorItems[i];
                        if (item.stepIndex < stepNumber && item.disabled === false) {
                            item.focus();
                            break;
                        }
                    }
                    break;
                }
            }
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.8", ngImport: i0, type: PrizmStepperSelectorComponent, deps: null, target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.8", type: PrizmStepperSelectorComponent, isStandalone: true, selector: "prizm-stepper-selector", inputs: { steps: "steps", currentStep: "currentStep", vertical: "vertical" }, outputs: { selectStep: "selectStep" }, host: { properties: { "class.vertical": "this.vertical" } }, viewQueries: [{ propertyName: "selectorItems", predicate: PrizmStepperSelectorItemDirective, descendants: true }], usesInheritance: true, ngImport: i0, template: "<ul class=\"steps\">\n  <ng-container *ngFor=\"let step of steps; last as isLastStep; first as isFirstStep; index as index\">\n    <li>\n      <button\n        class=\"step step--{{ step.status }} step--{{ index }}\"\n        [class.step--current]=\"currentStep === step.index\"\n        [class.step--disabled]=\"step.disabled\"\n        [class.step--first]=\"isFirstStep\"\n        [disabled]=\"step.disabled\"\n        [prizmStepperSelectorItem]=\"step.index\"\n        (click)=\"clickOnStep(step.index)\"\n        (keydown)=\"onKeyDown($event, step.index)\"\n      >\n        <span\n          class=\"step__index\"\n          *ngIf=\"!(currentStep === step.index && step.status !== 'default') && step.status !== null\"\n          [@inOut]\n        >\n          {{ step.index }}\n        </span>\n        <prizm-icon\n          class=\"step__icon\"\n          *ngIf=\"(currentStep === step.index && step.status !== 'default') || step.status === null\"\n          [@inOut]\n          [size]=\"24\"\n          [iconClass]=\"step.status === 'success' ? 'success-circle-fill' : 'alerts-circle-fill'\"\n        ></prizm-icon>\n        <span class=\"step__title\">{{ step.title }}</span>\n      </button>\n    </li>\n    <li class=\"line\" *ngIf=\"!isLastStep\" [ngClass]=\"{ 'line--first': isFirstStep }\"></li>\n  </ng-container>\n</ul>\n", styles: [":host{padding:16px;display:flex;border-bottom:1px solid var(--prizm-v3-background-stroke)}.steps{display:flex;align-items:center;width:100%}.step{display:flex;align-items:center;background:none;padding:0;border:none;outline:none;border:1px solid transparent;border-radius:2px;cursor:pointer}.step:focus .step__index,.step:focus .step__icon{box-shadow:0 0 0 2px var(--prizm-v3-background-stroke-focus)}.step__index{flex-shrink:0;flex-grow:0;display:flex;width:24px;height:24px;align-items:center;justify-content:center;border-radius:10000px;font-size:12px;line-height:1;color:transparent;border:1px solid transparent;transition:color .3s,background-color .3s,border-color .3s}.step__icon{transition:color .3s,background-color .3s,border-color .3s;border-radius:50%}.step__title{font-size:14px;line-height:16px;font-weight:600;color:var(--prizm-v3-text-icon-primary);padding:0 8px}.step--success .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-success-primary-default)}.step--success .step__icon{color:var(--prizm-v3-status-success-primary-default)}.step--success:hover .step__index,.step--success:focus .step__index{background-color:var(--prizm-v3-status-success-primary-hover);border-color:var(--prizm-v3-status-success-primary-hover)}.step--warning .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-warning-primary-default)}.step--warning .step__icon{color:var(--prizm-v3-status-warning-primary-default)}.step--warning:hover .step__index,.step--warning:focus .step__index{background-color:var(--prizm-v3-status-warning-primary-hover);border-color:var(--prizm-v3-status-warning-primary-hover)}.step--danger .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-alarm-primary-default)}.step--danger .step__icon{color:var(--prizm-v3-status-alarm-primary-default)}.step--danger:hover .step__index,.step--danger:focus .step__index{background-color:var(--prizm-v3-status-alarm-primary-hover);border-color:var(--prizm-v3-status-alarm-primary-hover)}.step--default .step__index{color:var(--prizm-v3-status-none-primary-default);border-color:var(--prizm-v3-status-none-primary-default)}.step--default:hover .step__index,.step--default:focus .step__index{color:var(--prizm-v3-text-icon-exception);border-color:var(--prizm-v3-status-none-primary-hover);background-color:var(--prizm-v3-status-none-primary-hover)}.step--current{cursor:default}.step--current .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-info-primary-default);border-color:var(--prizm-v3-status-info-primary-default)}.step--current:hover .step__index,.step--current:focus .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-info-primary-default);border-color:var(--prizm-v3-status-info-primary-default)}.step--disabled{cursor:not-allowed}.step--disabled .step__index{color:var(--prizm-v3-text-icon-disable);background-color:var(--prizm-v3-button-disable);border-color:var(--prizm-v3-button-disable)}.step--disabled:hover .step__index,.step--disabled:focus .step__index{color:var(--prizm-v3-text-icon-disable);background-color:var(--prizm-v3-button-disable);border-color:var(--prizm-v3-button-disable)}.line{flex-grow:1;display:block;height:2px;background-color:var(--prizm-v3-background-stroke);min-width:15px;margin:0 8px}.line--first{margin-left:0}:host-context(.vertical){border-bottom:none;border-right:1px solid var(--prizm-v3-background-stroke);align-items:flex-start;width:auto}:host-context(.vertical) .steps{flex-direction:column;align-items:flex-start}:host-context(.vertical) .step--first .step__title{padding:0 8px}:host-context(.vertical) .line{min-height:30px;min-width:auto;width:2px;margin:8px 0 8px 12px}\n"], dependencies: [{ kind: "ngmodule", type: CommonModule }, { kind: "directive", type: i1.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "component", type: PrizmIconComponent, selector: "prizm-icon", inputs: ["iconClass", "size"] }, { kind: "directive", type: PrizmStepperSelectorItemDirective, selector: "[prizmStepperSelectorItem]", inputs: ["prizmStepperSelectorItem", "disabled"] }], animations: [
            trigger('inOut', [
                transition(':enter', [style({ opacity: 0 }), animate('300ms', style({ opacity: 1 }))]),
            ]),
        ] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.8", ngImport: i0, type: PrizmStepperSelectorComponent, decorators: [{
            type: Component,
            args: [{ selector: 'prizm-stepper-selector', animations: [
                        trigger('inOut', [
                            transition(':enter', [style({ opacity: 0 }), animate('300ms', style({ opacity: 1 }))]),
                        ]),
                    ], standalone: true, imports: [CommonModule, PrizmIconComponent, PrizmStepperSelectorItemDirective], template: "<ul class=\"steps\">\n  <ng-container *ngFor=\"let step of steps; last as isLastStep; first as isFirstStep; index as index\">\n    <li>\n      <button\n        class=\"step step--{{ step.status }} step--{{ index }}\"\n        [class.step--current]=\"currentStep === step.index\"\n        [class.step--disabled]=\"step.disabled\"\n        [class.step--first]=\"isFirstStep\"\n        [disabled]=\"step.disabled\"\n        [prizmStepperSelectorItem]=\"step.index\"\n        (click)=\"clickOnStep(step.index)\"\n        (keydown)=\"onKeyDown($event, step.index)\"\n      >\n        <span\n          class=\"step__index\"\n          *ngIf=\"!(currentStep === step.index && step.status !== 'default') && step.status !== null\"\n          [@inOut]\n        >\n          {{ step.index }}\n        </span>\n        <prizm-icon\n          class=\"step__icon\"\n          *ngIf=\"(currentStep === step.index && step.status !== 'default') || step.status === null\"\n          [@inOut]\n          [size]=\"24\"\n          [iconClass]=\"step.status === 'success' ? 'success-circle-fill' : 'alerts-circle-fill'\"\n        ></prizm-icon>\n        <span class=\"step__title\">{{ step.title }}</span>\n      </button>\n    </li>\n    <li class=\"line\" *ngIf=\"!isLastStep\" [ngClass]=\"{ 'line--first': isFirstStep }\"></li>\n  </ng-container>\n</ul>\n", styles: [":host{padding:16px;display:flex;border-bottom:1px solid var(--prizm-v3-background-stroke)}.steps{display:flex;align-items:center;width:100%}.step{display:flex;align-items:center;background:none;padding:0;border:none;outline:none;border:1px solid transparent;border-radius:2px;cursor:pointer}.step:focus .step__index,.step:focus .step__icon{box-shadow:0 0 0 2px var(--prizm-v3-background-stroke-focus)}.step__index{flex-shrink:0;flex-grow:0;display:flex;width:24px;height:24px;align-items:center;justify-content:center;border-radius:10000px;font-size:12px;line-height:1;color:transparent;border:1px solid transparent;transition:color .3s,background-color .3s,border-color .3s}.step__icon{transition:color .3s,background-color .3s,border-color .3s;border-radius:50%}.step__title{font-size:14px;line-height:16px;font-weight:600;color:var(--prizm-v3-text-icon-primary);padding:0 8px}.step--success .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-success-primary-default)}.step--success .step__icon{color:var(--prizm-v3-status-success-primary-default)}.step--success:hover .step__index,.step--success:focus .step__index{background-color:var(--prizm-v3-status-success-primary-hover);border-color:var(--prizm-v3-status-success-primary-hover)}.step--warning .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-warning-primary-default)}.step--warning .step__icon{color:var(--prizm-v3-status-warning-primary-default)}.step--warning:hover .step__index,.step--warning:focus .step__index{background-color:var(--prizm-v3-status-warning-primary-hover);border-color:var(--prizm-v3-status-warning-primary-hover)}.step--danger .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-alarm-primary-default)}.step--danger .step__icon{color:var(--prizm-v3-status-alarm-primary-default)}.step--danger:hover .step__index,.step--danger:focus .step__index{background-color:var(--prizm-v3-status-alarm-primary-hover);border-color:var(--prizm-v3-status-alarm-primary-hover)}.step--default .step__index{color:var(--prizm-v3-status-none-primary-default);border-color:var(--prizm-v3-status-none-primary-default)}.step--default:hover .step__index,.step--default:focus .step__index{color:var(--prizm-v3-text-icon-exception);border-color:var(--prizm-v3-status-none-primary-hover);background-color:var(--prizm-v3-status-none-primary-hover)}.step--current{cursor:default}.step--current .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-info-primary-default);border-color:var(--prizm-v3-status-info-primary-default)}.step--current:hover .step__index,.step--current:focus .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-info-primary-default);border-color:var(--prizm-v3-status-info-primary-default)}.step--disabled{cursor:not-allowed}.step--disabled .step__index{color:var(--prizm-v3-text-icon-disable);background-color:var(--prizm-v3-button-disable);border-color:var(--prizm-v3-button-disable)}.step--disabled:hover .step__index,.step--disabled:focus .step__index{color:var(--prizm-v3-text-icon-disable);background-color:var(--prizm-v3-button-disable);border-color:var(--prizm-v3-button-disable)}.line{flex-grow:1;display:block;height:2px;background-color:var(--prizm-v3-background-stroke);min-width:15px;margin:0 8px}.line--first{margin-left:0}:host-context(.vertical){border-bottom:none;border-right:1px solid var(--prizm-v3-background-stroke);align-items:flex-start;width:auto}:host-context(.vertical) .steps{flex-direction:column;align-items:flex-start}:host-context(.vertical) .step--first .step__title{padding:0 8px}:host-context(.vertical) .line{min-height:30px;min-width:auto;width:2px;margin:8px 0 8px 12px}\n"] }]
        }], propDecorators: { steps: [{
                type: Input
            }], currentStep: [{
                type: Input
            }], vertical: [{
                type: Input
            }, {
                type: HostBinding,
                args: ['class.vertical']
            }], selectStep: [{
                type: Output
            }], selectorItems: [{
                type: ViewChildren,
                args: [PrizmStepperSelectorItemDirective]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RlcHBlci1zZWxlY3Rvci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL2NvbXBvbmVudHMvc3JjL2xpYi9jb21wb25lbnRzL3N0ZXBwZXIvc3RlcHBlci1zZWxlY3Rvci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL2NvbXBvbmVudHMvc3JjL2xpYi9jb21wb25lbnRzL3N0ZXBwZXIvc3RlcHBlci1zZWxlY3Rvci5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsT0FBTyxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDMUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM3RyxPQUFPLEVBQUUsaUNBQWlDLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUV0RixPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUNyRCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDL0MsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDNUQsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sbUJBQW1CLENBQUM7OztBQWN4RCxNQUFNLE9BQU8sNkJBQThCLFNBQVEsbUJBQW1CO0lBWnRFOztRQWFXLFVBQUssR0FBZ0MsRUFBRSxDQUFDO1FBTXZDLGVBQVUsR0FBRyxJQUFJLFlBQVksRUFBVSxDQUFDO1FBR2xELGtCQUFhLEdBQWlELG1CQUFtQixFQUFFLENBQUM7UUFDbEUsWUFBTyxHQUFHLHNCQUFzQixDQUFDO0tBeUNwRDtJQXZDUSxXQUFXLENBQUMsS0FBYTtRQUM5QixJQUFJLElBQUksQ0FBQyxXQUFXLEtBQUssS0FBSyxFQUFFO1lBQzlCLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQzdCO0lBQ0gsQ0FBQztJQUVNLFNBQVMsQ0FBQyxLQUFvQixFQUFFLFVBQWtCO1FBQ3ZELElBQUksQ0FBQyxZQUFZLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxXQUFXLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1lBQzNFLEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQztZQUV2QixNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBRW5ELFFBQVEsS0FBSyxDQUFDLEdBQUcsRUFBRTtnQkFDakIsS0FBSyxZQUFZLENBQUM7Z0JBQ2xCLEtBQUssU0FBUyxDQUFDLENBQUM7b0JBQ2QsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLGFBQWEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7d0JBQzdDLE1BQU0sSUFBSSxHQUFHLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQzt3QkFDOUIsSUFBSSxJQUFJLENBQUMsU0FBUyxHQUFHLFVBQVUsSUFBSSxJQUFJLENBQUMsUUFBUSxLQUFLLEtBQUssRUFBRTs0QkFDMUQsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDOzRCQUNiLE1BQU07eUJBQ1A7cUJBQ0Y7b0JBQ0QsTUFBTTtpQkFDUDtnQkFDRCxLQUFLLFdBQVcsQ0FBQztnQkFDakIsS0FBSyxXQUFXLENBQUMsQ0FBQztvQkFDaEIsS0FBSyxJQUFJLENBQUMsR0FBRyxhQUFhLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO3dCQUNsRCxNQUFNLElBQUksR0FBRyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUM7d0JBQzlCLElBQUksSUFBSSxDQUFDLFNBQVMsR0FBRyxVQUFVLElBQUksSUFBSSxDQUFDLFFBQVEsS0FBSyxLQUFLLEVBQUU7NEJBQzFELElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQzs0QkFDYixNQUFNO3lCQUNQO3FCQUNGO29CQUVELE1BQU07aUJBQ1A7YUFDRjtTQUNGO0lBQ0gsQ0FBQzs4R0FuRFUsNkJBQTZCO2tHQUE3Qiw2QkFBNkIsc1NBUzFCLGlDQUFpQyx1RUM5QmpELDB6Q0FpQ0EsK3dIRGRZLFlBQVksOFZBQUUsa0JBQWtCLHNGQUFFLGlDQUFpQywyR0FOakU7WUFDVixPQUFPLENBQUMsT0FBTyxFQUFFO2dCQUNmLFVBQVUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxLQUFLLENBQUMsRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxPQUFPLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUN2RixDQUFDO1NBQ0g7OzJGQUlVLDZCQUE2QjtrQkFaekMsU0FBUzsrQkFDRSx3QkFBd0IsY0FHdEI7d0JBQ1YsT0FBTyxDQUFDLE9BQU8sRUFBRTs0QkFDZixVQUFVLENBQUMsUUFBUSxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUUsT0FBTyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsT0FBTyxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7eUJBQ3ZGLENBQUM7cUJBQ0gsY0FDVyxJQUFJLFdBQ1AsQ0FBQyxZQUFZLEVBQUUsa0JBQWtCLEVBQUUsaUNBQWlDLENBQUM7OEJBR3JFLEtBQUs7c0JBQWIsS0FBSztnQkFFRyxXQUFXO3NCQUFuQixLQUFLO2dCQUVrQyxRQUFRO3NCQUEvQyxLQUFLOztzQkFBSSxXQUFXO3VCQUFDLGdCQUFnQjtnQkFFNUIsVUFBVTtzQkFBbkIsTUFBTTtnQkFHUCxhQUFhO3NCQURaLFlBQVk7dUJBQUMsaUNBQWlDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdHJpZ2dlciwgdHJhbnNpdGlvbiwgc3R5bGUsIGFuaW1hdGUgfSBmcm9tICdAYW5ndWxhci9hbmltYXRpb25zJztcbmltcG9ydCB7IENvbXBvbmVudCwgRXZlbnRFbWl0dGVyLCBIb3N0QmluZGluZywgSW5wdXQsIE91dHB1dCwgUXVlcnlMaXN0LCBWaWV3Q2hpbGRyZW4gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFByaXptU3RlcHBlclNlbGVjdG9ySXRlbURpcmVjdGl2ZSB9IGZyb20gJy4vc3RlcHBlci1zZWxlY3Rvci1pdGVtLmRpcmVjdGl2ZSc7XG5pbXBvcnQgeyBQcml6bVN0ZXBwZXJTdGVwRGlyZWN0aXZlIH0gZnJvbSAnLi9zdGVwcGVyLXN0ZXAuZGlyZWN0aXZlJztcbmltcG9ydCB7IFByaXptQWJzdHJhY3RUZXN0SWQgfSBmcm9tICdAcHJpem0tdWkvY29yZSc7XG5pbXBvcnQgeyBDb21tb25Nb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHsgUHJpem1JY29uQ29tcG9uZW50IH0gZnJvbSAnLi4vaWNvbi9pY29uLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBwcml6bUVtcHR5UXVlcnlMaXN0IH0gZnJvbSAnQHByaXptLXVpL2hlbHBlcnMnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdwcml6bS1zdGVwcGVyLXNlbGVjdG9yJyxcbiAgdGVtcGxhdGVVcmw6ICcuL3N0ZXBwZXItc2VsZWN0b3IuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9zdGVwcGVyLXNlbGVjdG9yLmNvbXBvbmVudC5sZXNzJ10sXG4gIGFuaW1hdGlvbnM6IFtcbiAgICB0cmlnZ2VyKCdpbk91dCcsIFtcbiAgICAgIHRyYW5zaXRpb24oJzplbnRlcicsIFtzdHlsZSh7IG9wYWNpdHk6IDAgfSksIGFuaW1hdGUoJzMwMG1zJywgc3R5bGUoeyBvcGFjaXR5OiAxIH0pKV0pLFxuICAgIF0pLFxuICBdLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICBpbXBvcnRzOiBbQ29tbW9uTW9kdWxlLCBQcml6bUljb25Db21wb25lbnQsIFByaXptU3RlcHBlclNlbGVjdG9ySXRlbURpcmVjdGl2ZV0sXG59KVxuZXhwb3J0IGNsYXNzIFByaXptU3RlcHBlclNlbGVjdG9yQ29tcG9uZW50IGV4dGVuZHMgUHJpem1BYnN0cmFjdFRlc3RJZCB7XG4gIEBJbnB1dCgpIHN0ZXBzOiBQcml6bVN0ZXBwZXJTdGVwRGlyZWN0aXZlW10gPSBbXTtcblxuICBASW5wdXQoKSBjdXJyZW50U3RlcCE6IG51bWJlcjtcblxuICBASW5wdXQoKSBASG9zdEJpbmRpbmcoJ2NsYXNzLnZlcnRpY2FsJykgdmVydGljYWwhOiBib29sZWFuO1xuXG4gIEBPdXRwdXQoKSBzZWxlY3RTdGVwID0gbmV3IEV2ZW50RW1pdHRlcjxudW1iZXI+KCk7XG5cbiAgQFZpZXdDaGlsZHJlbihQcml6bVN0ZXBwZXJTZWxlY3Rvckl0ZW1EaXJlY3RpdmUpXG4gIHNlbGVjdG9ySXRlbXM6IFF1ZXJ5TGlzdDxQcml6bVN0ZXBwZXJTZWxlY3Rvckl0ZW1EaXJlY3RpdmU+ID0gcHJpem1FbXB0eVF1ZXJ5TGlzdCgpO1xuICBvdmVycmlkZSByZWFkb25seSB0ZXN0SWRfID0gJ3VpX3N0ZXBwZXItLXNlbGVjdG9yJztcblxuICBwdWJsaWMgY2xpY2tPblN0ZXAoaW5kZXg6IG51bWJlcik6IHZvaWQge1xuICAgIGlmICh0aGlzLmN1cnJlbnRTdGVwICE9PSBpbmRleCkge1xuICAgICAgdGhpcy5zZWxlY3RTdGVwLm5leHQoaW5kZXgpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBvbktleURvd24oZXZlbnQ6IEtleWJvYXJkRXZlbnQsIHN0ZXBOdW1iZXI6IG51bWJlcik6IHZvaWQge1xuICAgIGlmIChbJ0Fycm93UmlnaHQnLCAnQXJyb3dMZWZ0JywgJ0Fycm93VXAnLCAnQXJyb3dEb3duJ10uaW5jbHVkZXMoZXZlbnQua2V5KSkge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgY29uc3Qgc2VsZWN0b3JJdGVtcyA9IHRoaXMuc2VsZWN0b3JJdGVtcy50b0FycmF5KCk7XG5cbiAgICAgIHN3aXRjaCAoZXZlbnQua2V5KSB7XG4gICAgICAgIGNhc2UgJ0Fycm93UmlnaHQnOlxuICAgICAgICBjYXNlICdBcnJvd1VwJzoge1xuICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0b3JJdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgaXRlbSA9IHNlbGVjdG9ySXRlbXNbaV07XG4gICAgICAgICAgICBpZiAoaXRlbS5zdGVwSW5kZXggPiBzdGVwTnVtYmVyICYmIGl0ZW0uZGlzYWJsZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgIGl0ZW0uZm9jdXMoKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ0Fycm93RG93bic6XG4gICAgICAgIGNhc2UgJ0Fycm93TGVmdCc6IHtcbiAgICAgICAgICBmb3IgKGxldCBpID0gc2VsZWN0b3JJdGVtcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgY29uc3QgaXRlbSA9IHNlbGVjdG9ySXRlbXNbaV07XG4gICAgICAgICAgICBpZiAoaXRlbS5zdGVwSW5kZXggPCBzdGVwTnVtYmVyICYmIGl0ZW0uZGlzYWJsZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgIGl0ZW0uZm9jdXMoKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiIsIjx1bCBjbGFzcz1cInN0ZXBzXCI+XG4gIDxuZy1jb250YWluZXIgKm5nRm9yPVwibGV0IHN0ZXAgb2Ygc3RlcHM7IGxhc3QgYXMgaXNMYXN0U3RlcDsgZmlyc3QgYXMgaXNGaXJzdFN0ZXA7IGluZGV4IGFzIGluZGV4XCI+XG4gICAgPGxpPlxuICAgICAgPGJ1dHRvblxuICAgICAgICBjbGFzcz1cInN0ZXAgc3RlcC0te3sgc3RlcC5zdGF0dXMgfX0gc3RlcC0te3sgaW5kZXggfX1cIlxuICAgICAgICBbY2xhc3Muc3RlcC0tY3VycmVudF09XCJjdXJyZW50U3RlcCA9PT0gc3RlcC5pbmRleFwiXG4gICAgICAgIFtjbGFzcy5zdGVwLS1kaXNhYmxlZF09XCJzdGVwLmRpc2FibGVkXCJcbiAgICAgICAgW2NsYXNzLnN0ZXAtLWZpcnN0XT1cImlzRmlyc3RTdGVwXCJcbiAgICAgICAgW2Rpc2FibGVkXT1cInN0ZXAuZGlzYWJsZWRcIlxuICAgICAgICBbcHJpem1TdGVwcGVyU2VsZWN0b3JJdGVtXT1cInN0ZXAuaW5kZXhcIlxuICAgICAgICAoY2xpY2spPVwiY2xpY2tPblN0ZXAoc3RlcC5pbmRleClcIlxuICAgICAgICAoa2V5ZG93bik9XCJvbktleURvd24oJGV2ZW50LCBzdGVwLmluZGV4KVwiXG4gICAgICA+XG4gICAgICAgIDxzcGFuXG4gICAgICAgICAgY2xhc3M9XCJzdGVwX19pbmRleFwiXG4gICAgICAgICAgKm5nSWY9XCIhKGN1cnJlbnRTdGVwID09PSBzdGVwLmluZGV4ICYmIHN0ZXAuc3RhdHVzICE9PSAnZGVmYXVsdCcpICYmIHN0ZXAuc3RhdHVzICE9PSBudWxsXCJcbiAgICAgICAgICBbQGluT3V0XVxuICAgICAgICA+XG4gICAgICAgICAge3sgc3RlcC5pbmRleCB9fVxuICAgICAgICA8L3NwYW4+XG4gICAgICAgIDxwcml6bS1pY29uXG4gICAgICAgICAgY2xhc3M9XCJzdGVwX19pY29uXCJcbiAgICAgICAgICAqbmdJZj1cIihjdXJyZW50U3RlcCA9PT0gc3RlcC5pbmRleCAmJiBzdGVwLnN0YXR1cyAhPT0gJ2RlZmF1bHQnKSB8fCBzdGVwLnN0YXR1cyA9PT0gbnVsbFwiXG4gICAgICAgICAgW0Bpbk91dF1cbiAgICAgICAgICBbc2l6ZV09XCIyNFwiXG4gICAgICAgICAgW2ljb25DbGFzc109XCJzdGVwLnN0YXR1cyA9PT0gJ3N1Y2Nlc3MnID8gJ3N1Y2Nlc3MtY2lyY2xlLWZpbGwnIDogJ2FsZXJ0cy1jaXJjbGUtZmlsbCdcIlxuICAgICAgICA+PC9wcml6bS1pY29uPlxuICAgICAgICA8c3BhbiBjbGFzcz1cInN0ZXBfX3RpdGxlXCI+e3sgc3RlcC50aXRsZSB9fTwvc3Bhbj5cbiAgICAgIDwvYnV0dG9uPlxuICAgIDwvbGk+XG4gICAgPGxpIGNsYXNzPVwibGluZVwiICpuZ0lmPVwiIWlzTGFzdFN0ZXBcIiBbbmdDbGFzc109XCJ7ICdsaW5lLS1maXJzdCc6IGlzRmlyc3RTdGVwIH1cIj48L2xpPlxuICA8L25nLWNvbnRhaW5lcj5cbjwvdWw+XG4iXX0=