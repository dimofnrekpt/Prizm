import { trigger, transition, style, animate } from '@angular/animations';
import { Component, EventEmitter, HostBinding, Input, Output, QueryList, ViewChildren } from '@angular/core';
import { PrizmStepperSelectorItemDirective } from './stepper-selector-item.directive';
import { PrizmAbstractTestId } from '@prizm-ui/core';
import { CommonModule } from '@angular/common';
import { PrizmIconComponent } from '../icon/icon.component';
import { prizmEmptyQueryList } from '@prizm-ui/helpers';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
export class PrizmStepperSelectorComponent extends PrizmAbstractTestId {
    constructor() {
        super(...arguments);
        this.steps = [];
        this.selectStep = new EventEmitter();
        this.selectorItems = prizmEmptyQueryList();
        this.testId_ = 'ui_stepper--selector';
    }
    clickOnStep(index) {
        if (this.currentStep !== index) {
            this.selectStep.next(index);
        }
    }
    onKeyDown(event, stepNumber) {
        if (['ArrowRight', 'ArrowLeft', 'ArrowUp', 'ArrowDown'].includes(event.key)) {
            event.preventDefault();
            const selectorItems = this.selectorItems.toArray();
            switch (event.key) {
                case 'ArrowRight':
                case 'ArrowUp': {
                    for (let i = 0; i < selectorItems.length; i++) {
                        const item = selectorItems[i];
                        if (item.stepIndex > stepNumber && item.disabled === false) {
                            item.focus();
                            break;
                        }
                    }
                    break;
                }
                case 'ArrowDown':
                case 'ArrowLeft': {
                    for (let i = selectorItems.length - 1; i >= 0; i--) {
                        const item = selectorItems[i];
                        if (item.stepIndex < stepNumber && item.disabled === false) {
                            item.focus();
                            break;
                        }
                    }
                    break;
                }
            }
        }
    }
}
PrizmStepperSelectorComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: PrizmStepperSelectorComponent, deps: null, target: i0.ɵɵFactoryTarget.Component });
PrizmStepperSelectorComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.9", type: PrizmStepperSelectorComponent, isStandalone: true, selector: "prizm-stepper-selector", inputs: { steps: "steps", currentStep: "currentStep", vertical: "vertical" }, outputs: { selectStep: "selectStep" }, host: { properties: { "class.vertical": "this.vertical" } }, viewQueries: [{ propertyName: "selectorItems", predicate: PrizmStepperSelectorItemDirective, descendants: true }], usesInheritance: true, ngImport: i0, template: "<ul class=\"steps\">\n  <ng-container *ngFor=\"let step of steps; last as isLastStep; first as isFirstStep; index as index\">\n    <li>\n      <button\n        class=\"step step--{{ step.status }} step--{{ index }}\"\n        [class.step--current]=\"currentStep === step.index\"\n        [class.step--disabled]=\"step.disabled\"\n        [class.step--first]=\"isFirstStep\"\n        [disabled]=\"step.disabled\"\n        [prizmStepperSelectorItem]=\"step.index\"\n        (click)=\"clickOnStep(step.index)\"\n        (keydown)=\"onKeyDown($event, step.index)\"\n      >\n        <span\n          class=\"step__index\"\n          *ngIf=\"!(currentStep === step.index && step.status !== 'default') && step.status !== null\"\n          [@inOut]\n        >\n          {{ step.index }}\n        </span>\n        <prizm-icon\n          class=\"step__icon\"\n          *ngIf=\"(currentStep === step.index && step.status !== 'default') || step.status === null\"\n          [@inOut]\n          [size]=\"24\"\n          [iconClass]=\"step.status === 'success' ? 'success-circle-fill' : 'alerts-circle-fill'\"\n        ></prizm-icon>\n        <span class=\"step__title\">{{ step.title }}</span>\n      </button>\n    </li>\n    <li class=\"line\" *ngIf=\"!isLastStep\" [ngClass]=\"{ 'line--first': isFirstStep }\"></li>\n  </ng-container>\n</ul>\n", styles: [":host{padding:16px;display:flex;border-bottom:1px solid var(--prizm-v3-background-stroke)}.steps{display:flex;align-items:center;width:100%}.step{display:flex;align-items:center;background:none;padding:0;border:none;outline:none;border:1px solid transparent;border-radius:2px;cursor:pointer}.step:focus .step__index,.step:focus .step__icon{box-shadow:0 0 0 2px var(--prizm-v3-background-stroke-focus)}.step__index{flex-shrink:0;flex-grow:0;display:flex;width:24px;height:24px;align-items:center;justify-content:center;border-radius:10000px;font-size:12px;line-height:1;color:transparent;border:1px solid transparent;transition:color .3s,background-color .3s,border-color .3s}.step__icon{transition:color .3s,background-color .3s,border-color .3s;border-radius:50%}.step__title{font-size:14px;line-height:16px;font-weight:600;color:var(--prizm-v3-text-icon-primary);padding:0 8px}.step--success .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-success-primary-default)}.step--success .step__icon{color:var(--prizm-v3-status-success-primary-default)}.step--success:hover .step__index,.step--success:focus .step__index{background-color:var(--prizm-v3-status-success-primary-hover);border-color:var(--prizm-v3-status-success-primary-hover)}.step--warning .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-warning-primary-default)}.step--warning .step__icon{color:var(--prizm-v3-status-warning-primary-default)}.step--warning:hover .step__index,.step--warning:focus .step__index{background-color:var(--prizm-v3-status-warning-primary-hover);border-color:var(--prizm-v3-status-warning-primary-hover)}.step--danger .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-alarm-primary-default)}.step--danger .step__icon{color:var(--prizm-v3-status-alarm-primary-default)}.step--danger:hover .step__index,.step--danger:focus .step__index{background-color:var(--prizm-v3-status-alarm-primary-hover);border-color:var(--prizm-v3-status-alarm-primary-hover)}.step--default .step__index{color:var(--prizm-v3-status-none-primary-default);border-color:var(--prizm-v3-status-none-primary-default)}.step--default:hover .step__index,.step--default:focus .step__index{color:var(--prizm-v3-text-icon-exception);border-color:var(--prizm-v3-status-none-primary-hover);background-color:var(--prizm-v3-status-none-primary-hover)}.step--current{cursor:default}.step--current .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-info-primary-default);border-color:var(--prizm-v3-status-info-primary-default)}.step--current:hover .step__index,.step--current:focus .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-info-primary-default);border-color:var(--prizm-v3-status-info-primary-default)}.step--disabled{cursor:not-allowed}.step--disabled .step__index{color:var(--prizm-v3-text-icon-disable);background-color:var(--prizm-v3-button-disable);border-color:var(--prizm-v3-button-disable)}.step--disabled:hover .step__index,.step--disabled:focus .step__index{color:var(--prizm-v3-text-icon-disable);background-color:var(--prizm-v3-button-disable);border-color:var(--prizm-v3-button-disable)}.line{flex-grow:1;display:block;height:2px;background-color:var(--prizm-v3-background-stroke);min-width:15px;margin:0 8px}.line--first{margin-left:0}:host-context(.vertical){border-bottom:none;border-right:1px solid var(--prizm-v3-background-stroke);align-items:flex-start;width:auto}:host-context(.vertical) .steps{flex-direction:column;align-items:flex-start}:host-context(.vertical) .step--first .step__title{padding:0 8px}:host-context(.vertical) .line{min-height:30px;min-width:auto;width:2px;margin:8px 0 8px 12px}\n"], dependencies: [{ kind: "ngmodule", type: CommonModule }, { kind: "directive", type: i1.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "component", type: PrizmIconComponent, selector: "prizm-icon", inputs: ["iconClass", "size"] }, { kind: "directive", type: PrizmStepperSelectorItemDirective, selector: "[prizmStepperSelectorItem]", inputs: ["prizmStepperSelectorItem", "disabled"] }], animations: [
        trigger('inOut', [
            transition(':enter', [style({ opacity: 0 }), animate('300ms', style({ opacity: 1 }))]),
        ]),
    ] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: PrizmStepperSelectorComponent, decorators: [{
            type: Component,
            args: [{ selector: 'prizm-stepper-selector', animations: [
                        trigger('inOut', [
                            transition(':enter', [style({ opacity: 0 }), animate('300ms', style({ opacity: 1 }))]),
                        ]),
                    ], standalone: true, imports: [CommonModule, PrizmIconComponent, PrizmStepperSelectorItemDirective], template: "<ul class=\"steps\">\n  <ng-container *ngFor=\"let step of steps; last as isLastStep; first as isFirstStep; index as index\">\n    <li>\n      <button\n        class=\"step step--{{ step.status }} step--{{ index }}\"\n        [class.step--current]=\"currentStep === step.index\"\n        [class.step--disabled]=\"step.disabled\"\n        [class.step--first]=\"isFirstStep\"\n        [disabled]=\"step.disabled\"\n        [prizmStepperSelectorItem]=\"step.index\"\n        (click)=\"clickOnStep(step.index)\"\n        (keydown)=\"onKeyDown($event, step.index)\"\n      >\n        <span\n          class=\"step__index\"\n          *ngIf=\"!(currentStep === step.index && step.status !== 'default') && step.status !== null\"\n          [@inOut]\n        >\n          {{ step.index }}\n        </span>\n        <prizm-icon\n          class=\"step__icon\"\n          *ngIf=\"(currentStep === step.index && step.status !== 'default') || step.status === null\"\n          [@inOut]\n          [size]=\"24\"\n          [iconClass]=\"step.status === 'success' ? 'success-circle-fill' : 'alerts-circle-fill'\"\n        ></prizm-icon>\n        <span class=\"step__title\">{{ step.title }}</span>\n      </button>\n    </li>\n    <li class=\"line\" *ngIf=\"!isLastStep\" [ngClass]=\"{ 'line--first': isFirstStep }\"></li>\n  </ng-container>\n</ul>\n", styles: [":host{padding:16px;display:flex;border-bottom:1px solid var(--prizm-v3-background-stroke)}.steps{display:flex;align-items:center;width:100%}.step{display:flex;align-items:center;background:none;padding:0;border:none;outline:none;border:1px solid transparent;border-radius:2px;cursor:pointer}.step:focus .step__index,.step:focus .step__icon{box-shadow:0 0 0 2px var(--prizm-v3-background-stroke-focus)}.step__index{flex-shrink:0;flex-grow:0;display:flex;width:24px;height:24px;align-items:center;justify-content:center;border-radius:10000px;font-size:12px;line-height:1;color:transparent;border:1px solid transparent;transition:color .3s,background-color .3s,border-color .3s}.step__icon{transition:color .3s,background-color .3s,border-color .3s;border-radius:50%}.step__title{font-size:14px;line-height:16px;font-weight:600;color:var(--prizm-v3-text-icon-primary);padding:0 8px}.step--success .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-success-primary-default)}.step--success .step__icon{color:var(--prizm-v3-status-success-primary-default)}.step--success:hover .step__index,.step--success:focus .step__index{background-color:var(--prizm-v3-status-success-primary-hover);border-color:var(--prizm-v3-status-success-primary-hover)}.step--warning .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-warning-primary-default)}.step--warning .step__icon{color:var(--prizm-v3-status-warning-primary-default)}.step--warning:hover .step__index,.step--warning:focus .step__index{background-color:var(--prizm-v3-status-warning-primary-hover);border-color:var(--prizm-v3-status-warning-primary-hover)}.step--danger .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-alarm-primary-default)}.step--danger .step__icon{color:var(--prizm-v3-status-alarm-primary-default)}.step--danger:hover .step__index,.step--danger:focus .step__index{background-color:var(--prizm-v3-status-alarm-primary-hover);border-color:var(--prizm-v3-status-alarm-primary-hover)}.step--default .step__index{color:var(--prizm-v3-status-none-primary-default);border-color:var(--prizm-v3-status-none-primary-default)}.step--default:hover .step__index,.step--default:focus .step__index{color:var(--prizm-v3-text-icon-exception);border-color:var(--prizm-v3-status-none-primary-hover);background-color:var(--prizm-v3-status-none-primary-hover)}.step--current{cursor:default}.step--current .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-info-primary-default);border-color:var(--prizm-v3-status-info-primary-default)}.step--current:hover .step__index,.step--current:focus .step__index{color:var(--prizm-v3-text-icon-exception);background-color:var(--prizm-v3-status-info-primary-default);border-color:var(--prizm-v3-status-info-primary-default)}.step--disabled{cursor:not-allowed}.step--disabled .step__index{color:var(--prizm-v3-text-icon-disable);background-color:var(--prizm-v3-button-disable);border-color:var(--prizm-v3-button-disable)}.step--disabled:hover .step__index,.step--disabled:focus .step__index{color:var(--prizm-v3-text-icon-disable);background-color:var(--prizm-v3-button-disable);border-color:var(--prizm-v3-button-disable)}.line{flex-grow:1;display:block;height:2px;background-color:var(--prizm-v3-background-stroke);min-width:15px;margin:0 8px}.line--first{margin-left:0}:host-context(.vertical){border-bottom:none;border-right:1px solid var(--prizm-v3-background-stroke);align-items:flex-start;width:auto}:host-context(.vertical) .steps{flex-direction:column;align-items:flex-start}:host-context(.vertical) .step--first .step__title{padding:0 8px}:host-context(.vertical) .line{min-height:30px;min-width:auto;width:2px;margin:8px 0 8px 12px}\n"] }]
        }], propDecorators: { steps: [{
                type: Input
            }], currentStep: [{
                type: Input
            }], vertical: [{
                type: Input
            }, {
                type: HostBinding,
                args: ['class.vertical']
            }], selectStep: [{
                type: Output
            }], selectorItems: [{
                type: ViewChildren,
                args: [PrizmStepperSelectorItemDirective]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RlcHBlci1zZWxlY3Rvci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL2NvbXBvbmVudHMvc3JjL2xpYi9jb21wb25lbnRzL3N0ZXBwZXIvc3RlcHBlci1zZWxlY3Rvci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL2NvbXBvbmVudHMvc3JjL2xpYi9jb21wb25lbnRzL3N0ZXBwZXIvc3RlcHBlci1zZWxlY3Rvci5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsT0FBTyxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDMUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM3RyxPQUFPLEVBQUUsaUNBQWlDLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUV0RixPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUNyRCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDL0MsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDNUQsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sbUJBQW1CLENBQUM7OztBQWN4RCxNQUFNLE9BQU8sNkJBQThCLFNBQVEsbUJBQW1CO0lBWnRFOztRQWFXLFVBQUssR0FBZ0MsRUFBRSxDQUFDO1FBTXZDLGVBQVUsR0FBRyxJQUFJLFlBQVksRUFBVSxDQUFDO1FBR2xELGtCQUFhLEdBQWlELG1CQUFtQixFQUFFLENBQUM7UUFDbEUsWUFBTyxHQUFHLHNCQUFzQixDQUFDO0tBeUNwRDtJQXZDUSxXQUFXLENBQUMsS0FBYTtRQUM5QixJQUFJ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c2l0aW9uLCBzdHlsZSwgYW5pbWF0ZSB9IGZyb20gJ0Bhbmd1bGFyL2FuaW1hdGlvbnMnO1xuaW1wb3J0IHsgQ29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIEhvc3RCaW5kaW5nLCBJbnB1dCwgT3V0cHV0LCBRdWVyeUxpc3QsIFZpZXdDaGlsZHJlbiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgUHJpem1TdGVwcGVyU2VsZWN0b3JJdGVtRGlyZWN0aXZlIH0gZnJvbSAnLi9zdGVwcGVyLXNlbGVjdG9yLWl0ZW0uZGlyZWN0aXZlJztcbmltcG9ydCB7IFByaXptU3RlcHBlclN0ZXBEaXJlY3RpdmUgfSBmcm9tICcuL3N0ZXBwZXItc3RlcC5kaXJlY3RpdmUnO1xuaW1wb3J0IHsgUHJpem1BYnN0cmFjdFRlc3RJZCB9IGZyb20gJ0Bwcml6bS11aS9jb3JlJztcbmltcG9ydCB7IENvbW1vbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBQcml6bUljb25Db21wb25lbnQgfSBmcm9tICcuLi9pY29uL2ljb24uY29tcG9uZW50JztcbmltcG9ydCB7IHByaXptRW1wdHlRdWVyeUxpc3QgfSBmcm9tICdAcHJpem0tdWkvaGVscGVycyc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3ByaXptLXN0ZXBwZXItc2VsZWN0b3InLFxuICB0ZW1wbGF0ZVVybDogJy4vc3RlcHBlci1zZWxlY3Rvci5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL3N0ZXBwZXItc2VsZWN0b3IuY29tcG9uZW50Lmxlc3MnXSxcbiAgYW5pbWF0aW9uczogW1xuICAgIHRyaWdnZXIoJ2luT3V0JywgW1xuICAgICAgdHJhbnNpdGlvbignOmVudGVyJywgW3N0eWxlKHsgb3BhY2l0eTogMCB9KSwgYW5pbWF0ZSgnMzAwbXMnLCBzdHlsZSh7IG9wYWNpdHk6IDEgfSkpXSksXG4gICAgXSksXG4gIF0sXG4gIHN0YW5kYWxvbmU6IHRydWUsXG4gIGltcG9ydHM6IFtDb21tb25Nb2R1bGUsIFByaXptSWNvbkNvbXBvbmVudCwgUHJpem1TdGVwcGVyU2VsZWN0b3JJdGVtRGlyZWN0aXZlXSxcbn0pXG5leHBvcnQgY2xhc3MgUHJpem1TdGVwcGVyU2VsZWN0b3JDb21wb25lbnQgZXh0ZW5kcyBQcml6bUFic3RyYWN0VGVzdElkIHtcbiAgQElucHV0KCkgc3RlcHM6IFByaXptU3RlcHBlclN0ZXBEaXJlY3RpdmVbXSA9IFtdO1xuXG4gIEBJbnB1dCgpIGN1cnJlbnRTdGVwITogbnVtYmVyO1xuXG4gIEBJbnB1dCgpIEBIb3N0QmluZGluZygnY2xhc3MudmVydGljYWwnKSB2ZXJ0aWNhbCE6IGJvb2xlYW47XG5cbiAgQE91dHB1dCgpIHNlbGVjdFN0ZXAgPSBuZXcgRXZlbnRFbWl0dGVyPG51bWJlcj4oKTtcblxuICBAVmlld0NoaWxkcmVuKFByaXptU3RlcHBlclNlbGVjdG9ySXRlbURpcmVjdGl2ZSlcbiAgc2VsZWN0b3JJdGVtczogUXVlcnlMaXN0PFByaXptU3RlcHBlclNlbGVjdG9ySXRlbURpcmVjdGl2ZT4gPSBwcml6bUVtcHR5UXVlcnlMaXN0KCk7XG4gIG92ZXJyaWRlIHJlYWRvbmx5IHRlc3RJZF8gPSAndWlfc3RlcHBlci0tc2VsZWN0b3InO1xuXG4gIHB1YmxpYyBjbGlja09uU3RlcChpbmRleDogbnVtYmVyKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY3VycmVudFN0ZXAgIT09IGluZGV4KSB7XG4gICAgICB0aGlzLnNlbGVjdFN0ZXAubmV4dChpbmRleCk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIG9uS2V5RG93bihldmVudDogS2V5Ym9hcmRFdmVudCwgc3RlcE51bWJlcjogbnVtYmVyKTogdm9pZCB7XG4gICAgaWYgKFsnQXJyb3dSaWdodCcsICdBcnJvd0xlZnQnLCAnQXJyb3dVcCcsICdBcnJvd0Rvd24nXS5pbmNsdWRlcyhldmVudC5rZXkpKSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICBjb25zdCBzZWxlY3Rvckl0ZW1zID0gdGhpcy5zZWxlY3Rvckl0ZW1zLnRvQXJyYXkoKTtcblxuICAgICAgc3dpdGNoIChldmVudC5rZXkpIHtcbiAgICAgICAgY2FzZSAnQXJyb3dSaWdodCc6XG4gICAgICAgIGNhc2UgJ0Fycm93VXAnOiB7XG4gICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3Rvckl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBpdGVtID0gc2VsZWN0b3JJdGVtc1tpXTtcbiAgICAgICAgICAgIGlmIChpdGVtLnN0ZXBJbmRleCA+IHN0ZXBOdW1iZXIgJiYgaXRlbS5kaXNhYmxlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgaXRlbS5mb2N1cygpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnQXJyb3dEb3duJzpcbiAgICAgICAgY2FzZSAnQXJyb3dMZWZ0Jzoge1xuICAgICAgICAgIGZvciAobGV0IGkgPSBzZWxlY3Rvckl0ZW1zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBjb25zdCBpdGVtID0gc2VsZWN0b3JJdGVtc1tpXTtcbiAgICAgICAgICAgIGlmIChpdGVtLnN0ZXBJbmRleCA8IHN0ZXBOdW1iZXIgJiYgaXRlbS5kaXNhYmxlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgaXRlbS5mb2N1cygpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIiwiPHVsIGNsYXNzPVwic3RlcHNcIj5cbiAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgc3RlcCBvZiBzdGVwczsgbGFzdCBhcyBpc0xhc3RTdGVwOyBmaXJzdCBhcyBpc0ZpcnN0U3RlcDsgaW5kZXggYXMgaW5kZXhcIj5cbiAgICA8bGk+XG4gICAgICA8YnV0dG9uXG4gICAgICAgIGNsYXNzPVwic3RlcCBzdGVwLS17eyBzdGVwLnN0YXR1cyB9fSBzdGVwLS17eyBpbmRleCB9fVwiXG4gICAgICAgIFtjbGFzcy5zdGVwLS1jdXJyZW50XT1cImN1cnJlbnRTdGVwID09PSBzdGVwLmluZGV4XCJcbiAgICAgICAgW2NsYXNzLnN0ZXAtLWRpc2FibGVkXT1cInN0ZXAuZGlzYWJsZWRcIlxuICAgICAgICBbY2xhc3Muc3RlcC0tZmlyc3RdPVwiaXNGaXJzdFN0ZXBcIlxuICAgICAgICBbZGlzYWJsZWRdPVwic3RlcC5kaXNhYmxlZFwiXG4gICAgICAgIFtwcml6bVN0ZXBwZXJTZWxlY3Rvckl0ZW1dPVwic3RlcC5pbmRleFwiXG4gICAgICAgIChjbGljayk9XCJjbGlja09uU3RlcChzdGVwLmluZGV4KVwiXG4gICAgICAgIChrZXlkb3duKT1cIm9uS2V5RG93bigkZXZlbnQsIHN0ZXAuaW5kZXgpXCJcbiAgICAgID5cbiAgICAgICAgPHNwYW5cbiAgICAgICAgICBjbGFzcz1cInN0ZXBfX2luZGV4XCJcbiAgICAgICAgICAqbmdJZj1cIiEoY3VycmVudFN0ZXAgPT09IHN0ZXAuaW5kZXggJiYgc3RlcC5zdGF0dXMgIT09ICdkZWZhdWx0JykgJiYgc3RlcC5zdGF0dXMgIT09IG51bGxcIlxuICAgICAgICAgIFtAaW5PdXRdXG4gICAgICAgID5cbiAgICAgICAgICB7eyBzdGVwLmluZGV4IH19XG4gICAgICAgIDwvc3Bhbj5cbiAgICAgICAgPHByaXptLWljb25cbiAgICAgICAgICBjbGFzcz1cInN0ZXBfX2ljb25cIlxuICAgICAgICAgICpuZ0lmPVwiKGN1cnJlbnRTdGVwID09PSBzdGVwLmluZGV4ICYmIHN0ZXAuc3RhdHVzICE9PSAnZGVmYXVsdCcpIHx8IHN0ZXAuc3RhdHVzID09PSBudWxsXCJcbiAgICAgICAgICBbQGluT3V0XVxuICAgICAgICAgIFtzaXplXT1cIjI0XCJcbiAgICAgICAgICBbaWNvbkNsYXNzXT1cInN0ZXAuc3RhdHVzID09PSAnc3VjY2VzcycgPyAnc3VjY2Vzcy1jaXJjbGUtZmlsbCcgOiAnYWxlcnRzLWNpcmNsZS1maWxsJ1wiXG4gICAgICAgID48L3ByaXptLWljb24+XG4gICAgICAgIDxzcGFuIGNsYXNzPVwic3RlcF9fdGl0bGVcIj57eyBzdGVwLnRpdGxlIH19PC9zcGFuPlxuICAgICAgPC9idXR0b24+XG4gICAgPC9saT5cbiAgICA8bGkgY2xhc3M9XCJsaW5lXCIgKm5nSWY9XCIhaXNMYXN0U3RlcFwiIFtuZ0NsYXNzXT1cInsgJ2xpbmUtLWZpcnN0JzogaXNGaXJzdFN0ZXAgfVwiPjwvbGk+XG4gIDwvbmctY29udGFpbmVyPlxuPC91bD5cbiJdfQ==