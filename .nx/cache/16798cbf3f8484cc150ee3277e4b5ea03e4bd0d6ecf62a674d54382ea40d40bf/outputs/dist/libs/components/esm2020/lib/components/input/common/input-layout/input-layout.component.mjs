import { ChangeDetectionStrategy, ChangeDetectorRef, Component, ContentChild, ElementRef, EventEmitter, HostBinding, Injector, Input, Output, ViewChild, } from '@angular/core';
import { BehaviorSubject, EMPTY, merge, Subject, timer } from 'rxjs';
import { PrizmInputControl } from '../base/input-control.class';
import { PrizmInputStatusTextDirective } from '../input-status-text/input-status-text.directive';
import { debounceTime, map, startWith, takeUntil, tap } from 'rxjs/operators';
import { isPolymorphPrimitive } from '../../../../directives/polymorph';
import { Compare, filterTruthy, PrizmDestroyService, PrizmLetDirective } from '@prizm-ui/helpers';
import { PrizmAbstractTestId } from '../../../../abstract/interactive';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "@prizm-ui/helpers";
import * as i3 from "../../../../directives/polymorph/directives/outlet";
import * as i4 from "../../../../directives/hint/hint.directive";
import * as i5 from "../input-icon-button/input-icon-button.component";
export class PrizmInputLayoutComponent extends PrizmAbstractTestId {
    set label(val) {
        this.label$.next(val);
    }
    get label() {
        return this.label$.value;
    }
    get hasHiddenControl() {
        return this.control.hidden;
    }
    get hasTextarea() {
        return this.control.nativeElementType === 'textarea';
    }
    get showClearButton() {
        if (this.disabled)
            return false;
        return typeof this.forceClear === 'boolean'
            ? this.forceClear
            : this.control.hasClearButton &&
                !this.letDirective?.context?.disabled &&
                !this.letDirective?.context?.empty;
    }
    get disabled() {
        return this.letDirective?.context?.disabled;
    }
    get enabled() {
        return !this.letDirective?.context?.disabled;
    }
    get correctedStatus() {
        return this.foundStatusDirective?.status && this.foundStatusDirective.enable
            ? this.foundStatusDirective.status
            : this.status;
    }
    get emptyLabel() {
        return !this.label?.replace(/[ ]+/, '');
    }
    get showStatusButton() {
        return Boolean(this.status !== 'default' ||
            (this.letDirective?.context?.invalid && this.letDirective?.context?.touched));
    }
    constructor(injector, el) {
        super();
        this.injector = injector;
        this.el = el;
        this.size = 'l';
        this.status = 'default';
        this.outer = false;
        this.clearButton = 'cancel-delete-content';
        this.border = true;
        this.position = 'left';
        this.forceClear = null;
        this.clear = new EventEmitter();
        this.testId_ = 'ui_input_layout';
        this.isPolymorphPrimitive = isPolymorphPrimitive;
        this.label$ = new BehaviorSubject(null);
        this.innerClick$$ = new Subject();
        this.innerClick$ = this.innerClick$$.asObservable();
        this.cdr = this.injector.get(ChangeDetectorRef);
        this.destroy$ = this.injector.get(PrizmDestroyService);
        this.changes$ = new Subject();
        this.onClearClick = (event) => {
            this.clear.next(event);
            this.control.clear(event);
            this.actualizeStatusIcon();
        };
    }
    ngOnInit() {
        this.control.stateChanges
            .pipe(debounceTime(10), tap(() => {
            this.actualizeStatusIcon();
            this.cdr.detectChanges();
        }), takeUntil(this.destroy$))
            .subscribe();
    }
    ngAfterViewInit() {
        this.actualizeStatusIcon();
        if (this.control.defaultLabel && Compare.isNullish(this.label)) {
            this.label$.next(this.control.defaultLabel);
        }
        merge(this.inputStatusText ? this.inputStatusText.changed.pipe(map(() => this.inputStatusText)) : EMPTY)
            .pipe(startWith(this.inputStatusText), map(i => i ?? this.control.statusText), filterTruthy(), tap(text => {
            this.foundStatusDirective = text;
            this.statusMessage = text.getStatusMessage();
            this.actualizeStatusIcon();
            this.cdr.detectChanges();
        }), takeUntil(this.destroy$))
            .subscribe();
        // NEED for get view children from nested controll
        timer(0)
            .pipe(tap(() => this.cdr.markForCheck()), takeUntil(this.destroy$))
            .subscribe();
    }
    ngOnChanges(changes) {
        if (changes.status) {
            this.actualizeStatusIcon();
        }
        this.changes$.next();
    }
    actualizeStatusIcon() {
        let statusIcon;
        switch (this.correctedStatus) {
            case 'warning':
                statusIcon = 'alerts-warning';
                break;
            case 'success':
                statusIcon = 'success-circle-fill';
                break;
            case 'danger':
                statusIcon = 'alerts-info-circle-fill';
                break;
            case 'default':
            default:
                break;
        }
        if (this.control.invalid) {
            statusIcon = 'alerts-info-circle-fill';
        }
        // eslint-disable-next-line @typescript-eslint/ban-ts-comment
        // @ts-ignore
        this.statusIcon = statusIcon;
    }
    innerClick(event) {
        this.innerClick$$.next(event);
    }
}
PrizmInputLayoutComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: PrizmInputLayoutComponent, deps: [{ token: i0.Injector }, { token: i0.ElementRef }], target: i0.ɵɵFactoryTarget.Component });
PrizmInputLayoutComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.9", type: PrizmInputLayoutComponent, selector: "prizm-input-layout", inputs: { label: "label", size: "size", status: "status", outer: "outer", clearButton: "clearButton", border: "border", position: "position", forceClear: "forceClear" }, outputs: { clear: "clear" }, host: { properties: { "class.has-hidden-control": "this.hasHiddenControl", "class.has-textarea": "this.hasTextarea", "class.disabled": "this.disabled", "class.enabled": "this.enabled" }, classAttribute: "prizm-input-layout" }, providers: [PrizmDestroyService], queries: [{ propertyName: "control", first: true, predicate: PrizmInputControl, descendants: true, static: true }, { propertyName: "inputStatusText", first: true, predicate: PrizmInputStatusTextDirective, descendants: true }], viewQueries: [{ propertyName: "letDirective", first: true, predicate: PrizmLetDirective, descendants: true }], usesInheritance: true, usesOnChanges: true, ngImport: i0, template: "<ng-container\n  *prizmLet=\"{\n    focused: control.focused | prizmToObservable | async,\n    disabled: control.disabled | prizmToObservable | async,\n    empty: control.empty | prizmToObservable | async,\n    touched: control.touched | prizmToObservable | async,\n    invalid: control.invalid | prizmToObservable | async,\n    required: control.required | prizmToObservable | async,\n    emptyLabel: emptyLabel\n  } as $\"\n>\n  <ng-template #labelTemplate>\n    <div\n      class=\"label-container\"\n      *ngIf=\"label$ | async\"\n      [ngClass]=\"[\n        control.nativeElementType ? 'label-container-' + control.nativeElementType : '',\n        'label-container-' + (outer ? 'outer' : 'inner')\n      ]\"\n      [class.label-container-focused]=\"$.focused\"\n      [attr.data-size]=\"size\"\n    >\n      <label\n        class=\"prizm-input-label\n    prizm-input-label-{{ outer ? 'outer' : 'inner' }}\n    prizm-input-label-{{ outer ? 'outer' : 'inner' }}-{{ position }}\n    {{ control.nativeElementType ? 'prizm-input-label-' + control.nativeElementType : '' }}\n\"\n        [attr.data-size]=\"size\"\n        [class.prizm-input-label-focused]=\"$.focused\"\n        [class.prizm-input-label-empty]=\"$.empty\"\n      >\n        <div class=\"label--title\">\n          {{ label$ | async }}\n        </div>\n        <span class=\"prizm-input-label-required\" *ngIf=\"$.required\">*</span>\n      </label>\n\n      <ng-container [ngSwitch]=\"isPolymorphPrimitive(clearButton)\">\n        <button\n          class=\"prizm-input-label-clear-btn clear-icon\"\n          *ngSwitchCase=\"true\"\n          [interactive]=\"true\"\n          [disabled]=\"$.disabled\"\n          [prizmInputIconButton]=\"$any(clearButton)\"\n          (click)=\"onClearClick($event)\"\n        ></button>\n\n        <div class=\"prizm-input-label-clear-btn clear-icon\" *ngSwitchDefault>\n          <ng-container\n            *polymorphOutlet=\"\n              clearButton;\n              context: { clear: onClearClick, showStatusButton: showStatusButton, disabled: $.disabled }\n            \"\n          >\n          </ng-container>\n        </div>\n      </ng-container>\n    </div>\n  </ng-template>\n\n  <ng-container *ngIf=\"!outer; else labelTemplate\"></ng-container>\n\n  <div\n    class=\"prizm-input-form\n  prizm-input-form-status-{{ correctedStatus }}\n  prizm-input-form-{{ outer ? 'outer' : 'inner' }}\n  prizm-input-form-{{ position }}\n  prizm-input-form-{{ outer ? 'outer' : 'inner' }}-{{ position }}\n  {{ control.nativeElementType ? 'prizm-input-form-' + control.nativeElementType : '' }}\n\"\n    [class.hide-border]=\"!border\"\n    [attr.data-size]=\"size\"\n    [ngClass]=\"{\n      'prizm-input-form-focused': !$.disabled && $.focused,\n      'prizm-input-form-empty': $.empty,\n      'prizm-input-empty-label': emptyLabel,\n      'prizm-input-form-disabled': $.disabled,\n      'prizm-input-form-touched': $.touched,\n      'prizm-input-form-invalid': $.invalid\n    }\"\n  >\n    <div class=\"prizm-input-form__first\">\n      <ng-container>\n        <ng-container *ngIf=\"control.layoutLeft?.templateRef as template\" [ngTemplateOutlet]=\"template\">\n        </ng-container>\n        <ng-content select=\"[prizm-input-left]\"></ng-content>\n      </ng-container>\n\n      <div class=\"prizm-input-form-inner-container\" (click)=\"innerClick($event)\">\n        <div class=\"prizm-input-form-body\">\n          <ng-container *ngIf=\"outer; else labelTemplate\"></ng-container>\n\n          <ng-content></ng-content>\n          <ng-container>\n            <ng-container *ngIf=\"control.layoutInBody?.templateRef as template\" [ngTemplateOutlet]=\"template\">\n            </ng-container>\n            <ng-content select=\"[prizm-input-in-body]\"></ng-content>\n          </ng-container>\n        </div>\n\n        <ng-container *ngIf=\"showClearButton\" [ngSwitch]=\"isPolymorphPrimitive(clearButton)\">\n          <button\n            class=\"prizm-input-label-clear-btn prizm-input-button-default clear-icon\"\n            *ngSwitchCase=\"true\"\n            [interactive]=\"true\"\n            [disabled]=\"$.disabled\"\n            [prizmInputIconButton]=\"$any(clearButton) ?? 'cancel-delete-content'\"\n            (click)=\"onClearClick($event)\"\n          ></button>\n\n          <div class=\"prizm-input-button-default clear-icon\" *ngSwitchDefault>\n            <ng-container\n              *polymorphOutlet=\"\n                clearButton;\n                context: { clear: onClearClick, showStatusButton: showStatusButton, disabled: $.disabled }\n              \"\n            >\n            </ng-container>\n          </div>\n        </ng-container>\n\n        <button\n          class=\"prizm-input-form-status-button\"\n          #statusButton\n          *ngIf=\"showStatusButton\"\n          [prizmInputIconButton]=\"statusIcon\"\n          [prizmHint]=\"statusMessage\"\n          [prizmHintCanShow]=\"!!statusMessage\"\n          [interactive]=\"false\"\n        ></button>\n      </div>\n\n      <ng-container>\n        <ng-container *ngIf=\"control.layoutRight?.templateRef as template\" [ngTemplateOutlet]=\"template\">\n        </ng-container>\n        <ng-content select=\"[prizm-input-right]\"></ng-content>\n      </ng-container>\n    </div>\n\n    <ng-container>\n      <ng-container *ngIf=\"control.layoutBottom?.templateRef as template\" [ngTemplateOutlet]=\"template\">\n      </ng-container>\n      <ng-content select=\"[prizm-input-bottom]\"></ng-content>\n    </ng-container>\n  </div>\n\n  <div class=\"prizm-input-form-subtext prizm-input-form-subtext-{{ correctedStatus }}\">\n    <ng-container>\n      <ng-container *ngIf=\"control.layoutSubtext?.templateRef as template\" [ngTemplateOutlet]=\"template\">\n      </ng-container>\n      <ng-content select=\"[prizm-input-subtext]\"></ng-content>\n    </ng-container>\n  </div>\n</ng-container>\n", styles: [":host{display:block;position:relative;width:var(--prizm-input-layout-width, 100%)}:host .prizm-input-form-status-button,:host .prizm-input-button-default{flex-shrink:0;height:100%}:host .prizm-input-button-default{display:none}:host:hover .prizm-input-button-default,:host:focus-within .prizm-input-button-default{display:block}.label-container{display:flex}.label-container .prizm-input-label-clear-btn{display:none;position:relative;bottom:2px;width:auto;padding-left:5px}.prizm-input-label{font-weight:600;font-size:12px;color:var(--prizm-v3-text-icon-tertiary);line-height:16px;transition:top .2s ease 0s;pointer-events:none;width:100%;display:flex;gap:4px}.prizm-input-label-required{color:var(--prizm-v3-status-alarm-primary-default)}.prizm-input-label-inner{position:absolute;display:flex;gap:4px;max-width:100%;width:100%}.prizm-input-label-inner[data-size=l]{top:5px}.prizm-input-label-inner[data-size=l].prizm-input-label-empty{top:13px}.prizm-input-label-inner[data-size=l].prizm-input-label-focused{top:5px}.prizm-input-label-inner[data-size=m]{top:1px}.prizm-input-label-inner[data-size=m].prizm-input-label-empty{top:9px}.prizm-input-label-inner[data-size=m].prizm-input-label-focused{top:1px}.prizm-input-label-inner-center{padding:0;left:50%;justify-content:center;transform:translate(-50%)}.prizm-input-form{background-color:var(--prizm-v3-form-fill-default);border:1px solid var(--prizm-v3-form-stroke-default);border-radius:2px;display:flex;flex-direction:column;padding:0 8px;justify-content:center;width:100%}.prizm-input-form.hide-border{border-color:transparent}.prizm-input-form .prizm-input-form-inner-container{flex:1;display:flex;align-items:center;position:relative}.prizm-input-form:hover{border-color:var(--prizm-v3-form-stroke-hover)}.prizm-input-form__first{display:flex;align-items:center;flex-grow:1}.prizm-input-form-body{position:relative;width:100%}.prizm-input-form-status-success{border-color:var(--prizm-v3-status-success-primary-default)}.prizm-input-form-status-success:hover{border-color:var(--prizm-v3-status-success-primary-hover)}.prizm-input-form-status-success .prizm-input-form-status-button{color:var(--prizm-v3-status-success-primary-default)}.prizm-input-form-status-warning{border-color:var(--prizm-v3-status-warning-primary-default)}.prizm-input-form-status-warning:hover{border-color:var(--prizm-v3-status-warning-primary-hover)}.prizm-input-form-status-warning .prizm-input-form-status-button{color:var(--prizm-v3-status-warning-primary-default)}.prizm-input-form-status-danger{border-color:var(--prizm-v3-status-alarm-primary-default)}.prizm-input-form-status-danger:hover{border-color:var(--prizm-v3-status-alarm-primary-hover)}.prizm-input-form-status-danger .prizm-input-form-status-button{color:var(--prizm-v3-status-alarm-primary-default)}.prizm-input-form-invalid.prizm-input-form-touched{border-color:var(--prizm-v3-status-alarm-primary-default)}.prizm-input-form-invalid .prizm-input-form-status-button{color:var(--prizm-v3-status-alarm-primary-default)}.prizm-input-form-focused,.prizm-input-form:focus-within{border-color:var(--prizm-v3-form-active);box-shadow:0 0 0 2px var(--prizm-v3-background-stroke-focus);position:relative}.prizm-input-form-focused:hover,.prizm-input-form:focus-within:hover{border-color:var(--prizm-v3-form-active-hover)}.prizm-input-form-focused .prizm-input-button-default,.prizm-input-form:focus-within .prizm-input-button-default{display:block}.prizm-input-form-disabled{border-color:transparent;cursor:not-allowed}.prizm-input-form-disabled:hover{border-color:transparent}.prizm-input-form-disabled ::ng-deep [prizmInputIconButton]{display:none}.prizm-input-form-inner,.prizm-input-form-inner[data-size=l]{min-height:44px}.prizm-input-form-inner[data-size=m]{min-height:36px}.prizm-input-form-outer{min-height:32px}.prizm-input-form-outer[data-size=l]{min-height:40px}.prizm-input-form-outer[data-size=m]{min-height:32px}.prizm-input-form-outer[data-size=s]{min-height:24px}.prizm-input-form-center .prizm-input-form-inner-container .prizm-input-form-status-button,.prizm-input-form-center .prizm-input-form-inner-container .prizm-input-button-default{position:absolute;z-index:100;background-color:var(--prizm-v3-form-fill-default)}.prizm-input-form-center .prizm-input-form-inner-container .prizm-input-button-default{right:32px}.prizm-input-form-center .prizm-input-form-inner-container .prizm-input-button-default.alone,.prizm-input-form-center .prizm-input-form-inner-container .prizm-input-form-status-button{right:0}.prizm-input-form-subtext{font-size:10px;font-weight:500;line-height:22px}.prizm-input-form-subtext-success{color:var(--prizm-v3-status-success-primary-default)}.prizm-input-form-subtext-warning{color:var(--prizm-v3-status-warning-primary-default)}.prizm-input-form-subtext-danger{color:var(--prizm-v3-status-alarm-primary-default)}.label--title{max-width:calc(100% - 20px);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;gap:4px}.clear-icon{z-index:2}.prizm-input-form-status-button{z-index:1}\n", ":host.has-hidden-control .label-container{height:16px;margin-bottom:2px}:host.has-hidden-control .label-container[data-size=m]{margin-bottom:4px}:host.has-hidden-control .label-container[data-size=l]{margin-bottom:8px}:host.has-hidden-control .label-container.label-container-inner{margin-bottom:0}:host.has-hidden-control .prizm-input-label-inner[data-size=l]{top:0}:host.has-hidden-control .prizm-input-label-inner[data-size=m]{top:0}:host.has-hidden-control .prizm-input-form .prizm-input-form-inner-container{padding:4px 0}:host.has-hidden-control .prizm-input-form .prizm-input-form-inner-container:host-context([data-size=\"l\"]){padding:6px 0}\n", ":host:has(::ng-deep textarea.resizable){display:table;width:auto}:host:hover .label-container-textarea.label-container-outer .prizm-input-label-clear-btn,:host:focus-within .label-container-textarea.label-container-outer .prizm-input-label-clear-btn{display:block}.label-container{display:flex}.label-container-focused.label-container-textarea.label-container-outer .prizm-input-label-clear-btn{display:block}.prizm-input-label-textarea.prizm-input-label-inner{background-color:var(--prizm-v3-form-fill-default);width:100%}.prizm-input-label-textarea.prizm-input-label-inner[data-size=l]{top:0;padding-top:5px}.prizm-input-label-textarea.prizm-input-label-inner[data-size=l].prizm-input-label-empty{top:0;padding-top:13px}.prizm-input-label-textarea.prizm-input-label-inner[data-size=l].prizm-input-label-focused{top:0;padding-top:5px}.prizm-input-label-textarea.prizm-input-label-inner[data-size=m]{top:0;padding-top:1px}.prizm-input-label-textarea.prizm-input-label-inner[data-size=m].prizm-input-label-empty{top:0;padding-top:9px}.prizm-input-label-textarea.prizm-input-label-inner[data-size=m].prizm-input-label-focused{top:0;padding-top:1px}.prizm-input-form-textarea{height:100%}.prizm-input-form-textarea .prizm-input-button-default{height:auto}.prizm-input-form-textarea .prizm-input-form__first{align-items:flex-start}.prizm-input-form-textarea .prizm-input-form-inner-container{align-self:stretch}.prizm-input-form-textarea .prizm-input-form-body{height:100%}.prizm-input-form-textarea .prizm-input-form-inner-container{align-items:flex-start}.prizm-input-form-textarea.prizm-input-form-inner .prizm-input-button-default{position:absolute;right:0}.prizm-input-form-textarea.prizm-input-form-inner[data-size=m] .prizm-input-button-default{padding-top:1px}.prizm-input-form-textarea.prizm-input-form-inner[data-size=l] .prizm-input-button-default{padding-top:5px}.prizm-input-form-textarea.prizm-input-form-outer .prizm-input-button-default{display:none}.prizm-input-form-textarea.prizm-input-form-outer[data-size=l] .prizm-input-button-default{padding-top:11px}.prizm-input-form-textarea.prizm-input-form-outer[data-size=m] .prizm-input-button-default{padding-top:7px}.prizm-input-form-textarea.prizm-input-form-outer[data-size=s] .prizm-input-button-default{padding-top:4px}.prizm-input-form:has(::ng-deep textarea.resizable){display:table}.prizm-input-form-textarea{display:table}\n"], dependencies: [{ kind: "directive", type: i1.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i1.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "directive", type: i1.NgSwitch, selector: "[ngSwitch]", inputs: ["ngSwitch"] }, { kind: "directive", type: i1.NgSwitchCase, selector: "[ngSwitchCase]", inputs: ["ngSwitchCase"] }, { kind: "directive", type: i1.NgSwitchDefault, selector: "[ngSwitchDefault]" }, { kind: "directive", type: i2.PrizmLetDirective, selector: "[prizmLet]", inputs: ["prizmLet"], exportAs: ["prizmLet"] }, { kind: "directive", type: i3.PolymorphOutletDirective, selector: "[polymorphOutlet]", inputs: ["polymorphOutlet", "polymorphOutletContext", "polymorphOutletInjector"] }, { kind: "directive", type: i4.PrizmHintDirective, selector: "[prizmHint]:not(ng-container)", inputs: ["prizmAutoReposition", "prizmHintDirection", "prizmHintId", "prizmHintTheme", "prizmHintShowDelay", "prizmHintHideDelay", "prizmHintHost", "prizmHintContext", "prizmHintCanShow", "prizmHint"], outputs: ["prizmHintShowed"], exportAs: ["prizmHint"] }, { kind: "component", type: i5.PrizmInputIconButtonComponent, selector: "button[prizmInputIconButton]", inputs: ["size", "prizmInputIconButton", "interactive", "disabled", "type"] }, { kind: "pipe", type: i1.AsyncPipe, name: "async" }, { kind: "pipe", type: i2.PrizmToObservablePipe, name: "prizmToObservable" }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: PrizmInputLayoutComponent, decorators: [{
            type: Component,
            args: [{ selector: 'prizm-input-layout', changeDetection: ChangeDetectionStrategy.OnPush, host: {
                        class: 'prizm-input-layout',
                    }, providers: [PrizmDestroyService], template: "<ng-container\n  *prizmLet=\"{\n    focused: control.focused | prizmToObservable | async,\n    disabled: control.disabled | prizmToObservable | async,\n    empty: control.empty | prizmToObservable | async,\n    touched: control.touched | prizmToObservable | async,\n    invalid: control.invalid | prizmToObservable | async,\n    required: control.required | prizmToObservable | async,\n    emptyLabel: emptyLabel\n  } as $\"\n>\n  <ng-template #labelTemplate>\n    <div\n      class=\"label-container\"\n      *ngIf=\"label$ | async\"\n      [ngClass]=\"[\n        control.nativeElementType ? 'label-container-' + control.nativeElementType : '',\n        'label-container-' + (outer ? 'outer' : 'inner')\n      ]\"\n      [class.label-container-focused]=\"$.focused\"\n      [attr.data-size]=\"size\"\n    >\n      <label\n        class=\"prizm-input-label\n    prizm-input-label-{{ outer ? 'outer' : 'inner' }}\n    prizm-input-label-{{ outer ? 'outer' : 'inner' }}-{{ position }}\n    {{ control.nativeElementType ? 'prizm-input-label-' + control.nativeElementType : '' }}\n\"\n        [attr.data-size]=\"size\"\n        [class.prizm-input-label-focused]=\"$.focused\"\n        [class.prizm-input-label-empty]=\"$.empty\"\n      >\n        <div class=\"label--title\">\n          {{ label$ | async }}\n        </div>\n        <span class=\"prizm-input-label-required\" *ngIf=\"$.required\">*</span>\n      </label>\n\n      <ng-container [ngSwitch]=\"isPolymorphPrimitive(clearButton)\">\n        <button\n          class=\"prizm-input-label-clear-btn clear-icon\"\n          *ngSwitchCase=\"true\"\n          [interactive]=\"true\"\n          [disabled]=\"$.disabled\"\n          [prizmInputIconButton]=\"$any(clearButton)\"\n          (click)=\"onClearClick($event)\"\n        ></button>\n\n        <div class=\"prizm-input-label-clear-btn clear-icon\" *ngSwitchDefault>\n          <ng-container\n            *polymorphOutlet=\"\n              clearButton;\n              context: { clear: onClearClick, showStatusButton: showStatusButton, disabled: $.disabled }\n            \"\n          >\n          </ng-container>\n        </div>\n      </ng-container>\n    </div>\n  </ng-template>\n\n  <ng-container *ngIf=\"!outer; else labelTemplate\"></ng-container>\n\n  <div\n    class=\"prizm-input-form\n  prizm-input-form-status-{{ correctedStatus }}\n  prizm-input-form-{{ outer ? 'outer' : 'inner' }}\n  prizm-input-form-{{ position }}\n  prizm-input-form-{{ outer ? 'outer' : 'inner' }}-{{ position }}\n  {{ control.nativeElementType ? 'prizm-input-form-' + control.nativeElementType : '' }}\n\"\n    [class.hide-border]=\"!border\"\n    [attr.data-size]=\"size\"\n    [ngClass]=\"{\n      'prizm-input-form-focused': !$.disabled && $.focused,\n      'prizm-input-form-empty': $.empty,\n      'prizm-input-empty-label': emptyLabel,\n      'prizm-input-form-disabled': $.disabled,\n      'prizm-input-form-touched': $.touched,\n      'prizm-input-form-invalid': $.invalid\n    }\"\n  >\n    <div class=\"prizm-input-form__first\">\n      <ng-container>\n        <ng-container *ngIf=\"control.layoutLeft?.templateRef as template\" [ngTemplateOutlet]=\"template\">\n        </ng-container>\n        <ng-content select=\"[prizm-input-left]\"></ng-content>\n      </ng-container>\n\n      <div class=\"prizm-input-form-inner-container\" (click)=\"innerClick($event)\">\n        <div class=\"prizm-input-form-body\">\n          <ng-container *ngIf=\"outer; else labelTemplate\"></ng-container>\n\n          <ng-content></ng-content>\n          <ng-container>\n            <ng-container *ngIf=\"control.layoutInBody?.templateRef as template\" [ngTemplateOutlet]=\"template\">\n            </ng-container>\n            <ng-content select=\"[prizm-input-in-body]\"></ng-content>\n          </ng-container>\n        </div>\n\n        <ng-container *ngIf=\"showClearButton\" [ngSwitch]=\"isPolymorphPrimitive(clearButton)\">\n          <button\n            class=\"prizm-input-label-clear-btn prizm-input-button-default clear-icon\"\n            *ngSwitchCase=\"true\"\n            [interactive]=\"true\"\n            [disabled]=\"$.disabled\"\n            [prizmInputIconButton]=\"$any(clearButton) ?? 'cancel-delete-content'\"\n            (click)=\"onClearClick($event)\"\n          ></button>\n\n          <div class=\"prizm-input-button-default clear-icon\" *ngSwitchDefault>\n            <ng-container\n              *polymorphOutlet=\"\n                clearButton;\n                context: { clear: onClearClick, showStatusButton: showStatusButton, disabled: $.disabled }\n              \"\n            >\n            </ng-container>\n          </div>\n        </ng-container>\n\n        <button\n          class=\"prizm-input-form-status-button\"\n          #statusButton\n          *ngIf=\"showStatusButton\"\n          [prizmInputIconButton]=\"statusIcon\"\n          [prizmHint]=\"statusMessage\"\n          [prizmHintCanShow]=\"!!statusMessage\"\n          [interactive]=\"false\"\n        ></button>\n      </div>\n\n      <ng-container>\n        <ng-container *ngIf=\"control.layoutRight?.templateRef as template\" [ngTemplateOutlet]=\"template\">\n        </ng-container>\n        <ng-content select=\"[prizm-input-right]\"></ng-content>\n      </ng-container>\n    </div>\n\n    <ng-container>\n      <ng-container *ngIf=\"control.layoutBottom?.templateRef as template\" [ngTemplateOutlet]=\"template\">\n      </ng-container>\n      <ng-content select=\"[prizm-input-bottom]\"></ng-content>\n    </ng-container>\n  </div>\n\n  <div class=\"prizm-input-form-subtext prizm-input-form-subtext-{{ correctedStatus }}\">\n    <ng-container>\n      <ng-container *ngIf=\"control.layoutSubtext?.templateRef as template\" [ngTemplateOutlet]=\"template\">\n      </ng-container>\n      <ng-content select=\"[prizm-input-subtext]\"></ng-content>\n    </ng-container>\n  </div>\n</ng-container>\n", styles: [":host{display:block;position:relative;width:var(--prizm-input-layout-width, 100%)}:host .prizm-input-form-status-button,:host .prizm-input-button-default{flex-shrink:0;height:100%}:host .prizm-input-button-default{display:none}:host:hover .prizm-input-button-default,:host:focus-within .prizm-input-button-default{display:block}.label-container{display:flex}.label-container .prizm-input-label-clear-btn{display:none;position:relative;bottom:2px;width:auto;padding-left:5px}.prizm-input-label{font-weight:600;font-size:12px;color:var(--prizm-v3-text-icon-tertiary);line-height:16px;transition:top .2s ease 0s;pointer-events:none;width:100%;display:flex;gap:4px}.prizm-input-label-required{color:var(--prizm-v3-status-alarm-primary-default)}.prizm-input-label-inner{position:absolute;display:flex;gap:4px;max-width:100%;width:100%}.prizm-input-label-inner[data-size=l]{top:5px}.prizm-input-label-inner[data-size=l].prizm-input-label-empty{top:13px}.prizm-input-label-inner[data-size=l].prizm-input-label-focused{top:5px}.prizm-input-label-inner[data-size=m]{top:1px}.prizm-input-label-inner[data-size=m].prizm-input-label-empty{top:9px}.prizm-input-label-inner[data-size=m].prizm-input-label-focused{top:1px}.prizm-input-label-inner-center{padding:0;left:50%;justify-content:center;transform:translate(-50%)}.prizm-input-form{background-color:var(--prizm-v3-form-fill-default);border:1px solid var(--prizm-v3-form-stroke-default);border-radius:2px;display:flex;flex-direction:column;padding:0 8px;justify-content:center;width:100%}.prizm-input-form.hide-border{border-color:transparent}.prizm-input-form .prizm-input-form-inner-container{flex:1;display:flex;align-items:center;position:relative}.prizm-input-form:hover{border-color:var(--prizm-v3-form-stroke-hover)}.prizm-input-form__first{display:flex;align-items:center;flex-grow:1}.prizm-input-form-body{position:relative;width:100%}.prizm-input-form-status-success{border-color:var(--prizm-v3-status-success-primary-default)}.prizm-input-form-status-success:hover{border-color:var(--prizm-v3-status-success-primary-hover)}.prizm-input-form-status-success .prizm-input-form-status-button{color:var(--prizm-v3-status-success-primary-default)}.prizm-input-form-status-warning{border-color:var(--prizm-v3-status-warning-primary-default)}.prizm-input-form-status-warning:hover{border-color:var(--prizm-v3-status-warning-primary-hover)}.prizm-input-form-status-warning .prizm-input-form-status-button{color:var(--prizm-v3-status-warning-primary-default)}.prizm-input-form-status-danger{border-color:var(--prizm-v3-status-alarm-primary-default)}.prizm-input-form-status-danger:hover{border-color:var(--prizm-v3-status-alarm-primary-hover)}.prizm-input-form-status-danger .prizm-input-form-status-button{color:var(--prizm-v3-status-alarm-primary-default)}.prizm-input-form-invalid.prizm-input-form-touched{border-color:var(--prizm-v3-status-alarm-primary-default)}.prizm-input-form-invalid .prizm-input-form-status-button{color:var(--prizm-v3-status-alarm-primary-default)}.prizm-input-form-focused,.prizm-input-form:focus-within{border-color:var(--prizm-v3-form-active);box-shadow:0 0 0 2px var(--prizm-v3-background-stroke-focus);position:relative}.prizm-input-form-focused:hover,.prizm-input-form:focus-within:hover{border-color:var(--prizm-v3-form-active-hover)}.prizm-input-form-focused .prizm-input-button-default,.prizm-input-form:focus-within .prizm-input-button-default{display:block}.prizm-input-form-disabled{border-color:transparent;cursor:not-allowed}.prizm-input-form-disabled:hover{border-color:transparent}.prizm-input-form-disabled ::ng-deep [prizmInputIconButton]{display:none}.prizm-input-form-inner,.prizm-input-form-inner[data-size=l]{min-height:44px}.prizm-input-form-inner[data-size=m]{min-height:36px}.prizm-input-form-outer{min-height:32px}.prizm-input-form-outer[data-size=l]{min-height:40px}.prizm-input-form-outer[data-size=m]{min-height:32px}.prizm-input-form-outer[data-size=s]{min-height:24px}.prizm-input-form-center .prizm-input-form-inner-container .prizm-input-form-status-button,.prizm-input-form-center .prizm-input-form-inner-container .prizm-input-button-default{position:absolute;z-index:100;background-color:var(--prizm-v3-form-fill-default)}.prizm-input-form-center .prizm-input-form-inner-container .prizm-input-button-default{right:32px}.prizm-input-form-center .prizm-input-form-inner-container .prizm-input-button-default.alone,.prizm-input-form-center .prizm-input-form-inner-container .prizm-input-form-status-button{right:0}.prizm-input-form-subtext{font-size:10px;font-weight:500;line-height:22px}.prizm-input-form-subtext-success{color:var(--prizm-v3-status-success-primary-default)}.prizm-input-form-subtext-warning{color:var(--prizm-v3-status-warning-primary-default)}.prizm-input-form-subtext-danger{color:var(--prizm-v3-status-alarm-primary-default)}.label--title{max-width:calc(100% - 20px);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;gap:4px}.clear-icon{z-index:2}.prizm-input-form-status-button{z-index:1}\n", ":host.has-hidden-control .label-container{height:16px;margin-bottom:2px}:host.has-hidden-control .label-container[data-size=m]{margin-bottom:4px}:host.has-hidden-control .label-container[data-size=l]{margin-bottom:8px}:host.has-hidden-control .label-container.label-container-inner{margin-bottom:0}:host.has-hidden-control .prizm-input-label-inner[data-size=l]{top:0}:host.has-hidden-control .prizm-input-label-inner[data-size=m]{top:0}:host.has-hidden-control .prizm-input-form .prizm-input-form-inner-container{padding:4px 0}:host.has-hidden-control .prizm-input-form .prizm-input-form-inner-container:host-context([data-size=\"l\"]){padding:6px 0}\n", ":host:has(::ng-deep textarea.resizable){display:table;width:auto}:host:hover .label-container-textarea.label-container-outer .prizm-input-label-clear-btn,:host:focus-within .label-container-textarea.label-container-outer .prizm-input-label-clear-btn{display:block}.label-container{display:flex}.label-container-focused.label-container-textarea.label-container-outer .prizm-input-label-clear-btn{display:block}.prizm-input-label-textarea.prizm-input-label-inner{background-color:var(--prizm-v3-form-fill-default);width:100%}.prizm-input-label-textarea.prizm-input-label-inner[data-size=l]{top:0;padding-top:5px}.prizm-input-label-textarea.prizm-input-label-inner[data-size=l].prizm-input-label-empty{top:0;padding-top:13px}.prizm-input-label-textarea.prizm-input-label-inner[data-size=l].prizm-input-label-focused{top:0;padding-top:5px}.prizm-input-label-textarea.prizm-input-label-inner[data-size=m]{top:0;padding-top:1px}.prizm-input-label-textarea.prizm-input-label-inner[data-size=m].prizm-input-label-empty{top:0;padding-top:9px}.prizm-input-label-textarea.prizm-input-label-inner[data-size=m].prizm-input-label-focused{top:0;padding-top:1px}.prizm-input-form-textarea{height:100%}.prizm-input-form-textarea .prizm-input-button-default{height:auto}.prizm-input-form-textarea .prizm-input-form__first{align-items:flex-start}.prizm-input-form-textarea .prizm-input-form-inner-container{align-self:stretch}.prizm-input-form-textarea .prizm-input-form-body{height:100%}.prizm-input-form-textarea .prizm-input-form-inner-container{align-items:flex-start}.prizm-input-form-textarea.prizm-input-form-inner .prizm-input-button-default{position:absolute;right:0}.prizm-input-form-textarea.prizm-input-form-inner[data-size=m] .prizm-input-button-default{padding-top:1px}.prizm-input-form-textarea.prizm-input-form-inner[data-size=l] .prizm-input-button-default{padding-top:5px}.prizm-input-form-textarea.prizm-input-form-outer .prizm-input-button-default{display:none}.prizm-input-form-textarea.prizm-input-form-outer[data-size=l] .prizm-input-button-default{padding-top:11px}.prizm-input-form-textarea.prizm-input-form-outer[data-size=m] .prizm-input-button-default{padding-top:7px}.prizm-input-form-textarea.prizm-input-form-outer[data-size=s] .prizm-input-button-default{padding-top:4px}.prizm-input-form:has(::ng-deep textarea.resizable){display:table}.prizm-input-form-textarea{display:table}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.Injector }, { type: i0.ElementRef }]; }, propDecorators: { label: [{
                type: Input
            }], size: [{
                type: Input
            }], status: [{
                type: Input
            }], outer: [{
                type: Input
            }], clearButton: [{
                type: Input
            }], border: [{
                type: Input
            }], position: [{
                type: Input
            }], forceClear: [{
                type: Input
            }], clear: [{
                type: Output
            }], letDirective: [{
                type: ViewChild,
                args: [PrizmLetDirective]
            }], hasHiddenControl: [{
                type: HostBinding,
                args: ['class.has-hidden-control']
            }], hasTextarea: [{
                type: HostBinding,
                args: ['class.has-textarea']
            }], control: [{
                type: ContentChild,
                args: [PrizmInputControl, { static: true }]
            }], inputStatusText: [{
                type: ContentChild,
                args: [PrizmInputStatusTextDirective, { static: false }]
            }], disabled: [{
                type: HostBinding,
                args: ['class.disabled']
            }], enabled: [{
                type: HostBinding,
                args: ['class.enabled']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5wdXQtbGF5b3V0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL2xpYnMvY29tcG9uZW50cy9zcmMvbGliL2NvbXBvbmVudHMvaW5wdXQvY29tbW9uL2lucHV0LWxheW91dC9pbnB1dC1sYXlvdXQuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vbGlicy9jb21wb25lbnRzL3NyYy9saWIvY29tcG9uZW50cy9pbnB1dC9jb21tb24vaW5wdXQtbGF5b3V0L2lucHV0LWxheW91dC5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBRUwsdUJBQXVCLEVBQ3ZCLGlCQUFpQixFQUNqQixTQUFTLEVBQ1QsWUFBWSxFQUNaLFVBQVUsRUFDVixZQUFZLEVBQ1osV0FBVyxFQUNYLFFBQVEsRUFDUixLQUFLLEVBR0wsTUFBTSxFQUVOLFNBQVMsR0FDVixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsZUFBZSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUNyRSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQztBQUNoRSxPQUFPLEVBQUUsNkJBQTZCLEVBQUUsTUFBTSxrREFBa0QsQ0FBQztBQUVqRyxPQUFPLEVBQUUsWUFBWSxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzlFLE9BQU8sRUFBRSxvQkFBb0IsRUFBd0MsTUFBTSxrQ0FBa0MsQ0FBQztBQUM5RyxPQUFPLEVBQUUsT0FBTyxFQUFFLFlBQVksRUFBRSxtQkFBbUIsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xHLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLGtDQUFrQyxDQUFD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QjtnQkFJQSxXQUFXO3NCQUFqRCxXQUFXO3VCQUFDLG9CQUFvQjtnQkFpQmtCLE9BQU87c0JBQXpELFlBQVk7dUJBQUMsaUJBQWlCLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFO2dCQUVqRCxlQUFlO3NCQURkLFlBQVk7dUJBQUMsNkJBQTZCLEVBQUUsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFO2dCQU0zQixRQUFRO3NCQUExQyxXQUFXO3VCQUFDLGdCQUFnQjtnQkFHSyxPQUFPO3NCQUF4QyxXQUFXO3VCQUFDLGVBQWUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBZnRlclZpZXdJbml0LFxuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gIENvbXBvbmVudCxcbiAgQ29udGVudENoaWxkLFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsXG4gIEhvc3RCaW5kaW5nLFxuICBJbmplY3RvcixcbiAgSW5wdXQsXG4gIE9uQ2hhbmdlcyxcbiAgT25Jbml0LFxuICBPdXRwdXQsXG4gIFNpbXBsZUNoYW5nZXMsXG4gIFZpZXdDaGlsZCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QsIEVNUFRZLCBtZXJnZSwgU3ViamVjdCwgdGltZXIgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IFByaXptSW5wdXRDb250cm9sIH0gZnJvbSAnLi4vYmFzZS9pbnB1dC1jb250cm9sLmNsYXNzJztcbmltcG9ydCB7IFByaXptSW5wdXRTdGF0dXNUZXh0RGlyZWN0aXZlIH0gZnJvbSAnLi4vaW5wdXQtc3RhdHVzLXRleHQvaW5wdXQtc3RhdHVzLXRleHQuZGlyZWN0aXZlJztcbmltcG9ydCB7IFByaXptSW5wdXRQb3NpdGlvbiwgUHJpem1JbnB1dFNpemUsIFByaXptSW5wdXRTdGF0dXMgfSBmcm9tICcuLi9tb2RlbHMvcHJpem0taW5wdXQubW9kZWxzJztcbmltcG9ydCB7IGRlYm91bmNlVGltZSwgbWFwLCBzdGFydFdpdGgsIHRha2VVbnRpbCwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgaXNQb2x5bW9ycGhQcmltaXRpdmUsIFBvbHltb3JwaENvbXBvbmVudCwgUG9seW1vcnBoQ29udGVudCB9IGZyb20gJy4uLy4uLy4uLy4uL2RpcmVjdGl2ZXMvcG9seW1vcnBoJztcbmltcG9ydCB7IENvbXBhcmUsIGZpbHRlclRydXRoeSwgUHJpem1EZXN0cm95U2VydmljZSwgUHJpem1MZXREaXJlY3RpdmUgfSBmcm9tICdAcHJpem0tdWkvaGVscGVycyc7XG5pbXBvcnQgeyBQcml6bUFic3RyYWN0VGVzdElkIH0gZnJvbSAnLi4vLi4vLi4vLi4vYWJzdHJhY3QvaW50ZXJhY3RpdmUnO1xuXG5leHBvcnQgdHlwZSBQcml6bUlucHV0TGF5b3V0Q2xlYXJCdXR0b25Db250ZXh0ID0ge1xuICBjbGVhcjogKGV2ZW50OiBNb3VzZUV2ZW50KSA9PiB2b2lkO1xuICBkaXNhYmxlZDogYm9vbGVhbjtcbiAgc2hvd1N0YXR1c0J1dHRvbjogYm9vbGVhbjtcbn07XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3ByaXptLWlucHV0LWxheW91dCcsXG4gIHRlbXBsYXRlVXJsOiAnLi9pbnB1dC1sYXlvdXQuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFtcbiAgICAnLi9pbnB1dC1sYXlvdXQuY29tcG9uZW50Lmxlc3MnLFxuICAgICcuL2lucHV0LWxheW91dC1oaWRkZW4tY29udHJvbC5jb21wb25lbnQubGVzcycsXG4gICAgJy4vaW5wdXQtbGF5b3V0LXRleHRhcmVhLmNvbXBvbmVudC5sZXNzJyxcbiAgXSxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvbm8taG9zdC1tZXRhZGF0YS1wcm9wZXJ0eVxuICBob3N0OiB7XG4gICAgY2xhc3M6ICdwcml6bS1pbnB1dC1sYXlvdXQnLFxuICB9LFxuICBwcm92aWRlcnM6IFtQcml6bURlc3Ryb3lTZXJ2aWNlXSxcbn0pXG5leHBvcnQgY2xhc3MgUHJpem1JbnB1dExheW91dENvbXBvbmVudFxuICBleHRlbmRzIFByaXptQWJzdHJhY3RUZXN0SWRcbiAgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcywgQWZ0ZXJWaWV3SW5pdFxue1xuICBASW5wdXQoKSBzZXQgbGFiZWwodmFsOiBzdHJpbmcgfCBudWxsKSB7XG4gICAgdGhpcy5sYWJlbCQubmV4dCh2YWwpO1xuICB9XG4gIGdldCBsYWJlbCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmxhYmVsJC52YWx1ZSBhcyBzdHJpbmc7XG4gIH1cblxuICBASW5wdXQoKSBzaXplOiBQcml6bUlucHV0U2l6ZSA9ICdsJztcblxuICBASW5wdXQoKSBzdGF0dXM6IFByaXptSW5wdXRTdGF0dXMgPSAnZGVmYXVsdCc7XG5cbiAgQElucHV0KCkgb3V0ZXIgPSBmYWxzZTtcblxuICBASW5wdXQoKSBjbGVhckJ1dHRvbjogUG9seW1vcnBoQ29udGVudDxQcml6bUlucHV0TGF5b3V0Q2xlYXJCdXR0b25Db250ZXh0PiA9ICdjYW5jZWwtZGVsZXRlLWNvbnRlbnQnO1xuXG4gIEBJbnB1dCgpIGJvcmRlciA9IHRydWU7XG4gIEBJbnB1dCgpIHBvc2l0aW9uOiBQcml6bUlucHV0UG9zaXRpb24gPSAnbGVmdCc7XG4gIEBJbnB1dCgpIGZvcmNlQ2xlYXI6IGJvb2xlYW4gfCBudWxsID0gbnVsbDtcbiAgQE91dHB1dCgpIGNsZWFyID0gbmV3IEV2ZW50RW1pdHRlcjxNb3VzZUV2ZW50PigpO1xuXG4gIEBWaWV3Q2hpbGQoUHJpem1MZXREaXJlY3RpdmUpIGxldERpcmVjdGl2ZSE6IFByaXptTGV0RGlyZWN0aXZlPHtcbiAgICBmb2N1c2VkOiBib29sZWFuO1xuICAgIGRpc2FibGVkOiBib29sZWFuO1xuICAgIGVtcHR5OiBib29sZWFuO1xuICAgIHRvdWNoZWQ6IGJvb2xlYW47XG4gICAgaW52YWxpZDogYm9vbGVhbjtcbiAgICByZXF1aXJlZDogYm9vbGVhbjtcbiAgfT47XG5cbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5oYXMtaGlkZGVuLWNvbnRyb2wnKSBnZXQgaGFzSGlkZGVuQ29udHJvbCgpIHtcbiAgICByZXR1cm4gdGhpcy5jb250cm9sLmhpZGRlbjtcbiAgfVxuXG4gIEBIb3N0QmluZGluZygnY2xhc3MuaGFzLXRleHRhcmVhJykgZ2V0IGhhc1RleHRhcmVhKCkge1xuICAgIHJldHVybiB0aGlzLmNvbnRyb2wubmF0aXZlRWxlbWVudFR5cGUgPT09ICd0ZXh0YXJlYSc7XG4gIH1cblxuICBvdmVycmlkZSB0ZXN0SWRfID0gJ3VpX2lucHV0X2xheW91dCc7XG4gIHByb3RlY3RlZCByZWFkb25seSBpc1BvbHltb3JwaFByaW1pdGl2ZSA9IGlzUG9seW1vcnBoUHJpbWl0aXZlO1xuXG4gIHB1YmxpYyByZWFkb25seSBsYWJlbCQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PHN0cmluZyB8IG51bGw+KG51bGwpO1xuICBnZXQgc2hvd0NsZWFyQnV0dG9uKCk6IGJvb2xlYW4ge1xuICAgIGlmICh0aGlzLmRpc2FibGVkKSByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuIHR5cGVvZiB0aGlzLmZvcmNlQ2xlYXIgPT09ICdib29sZWFuJ1xuICAgICAgPyB0aGlzLmZvcmNlQ2xlYXJcbiAgICAgIDogdGhpcy5jb250cm9sLmhhc0NsZWFyQnV0dG9uICYmXG4gICAgICAgICAgIXRoaXMubGV0RGlyZWN0aXZlPy5jb250ZXh0Py5kaXNhYmxlZCAmJlxuICAgICAgICAgICF0aGlzLmxldERpcmVjdGl2ZT8uY29udGV4dD8uZW1wdHk7XG4gIH1cblxuICBAQ29udGVudENoaWxkKFByaXptSW5wdXRDb250cm9sLCB7IHN0YXRpYzogdHJ1ZSB9KSBjb250cm9sITogUHJpem1JbnB1dENvbnRyb2w8YW55PjtcbiAgQENvbnRlbnRDaGlsZChQcml6bUlucHV0U3RhdHVzVGV4dERpcmVjdGl2ZSwgeyBzdGF0aWM6IGZhbHNlIH0pXG4gIGlucHV0U3RhdHVzVGV4dCE6IFByaXptSW5wdXRTdGF0dXNUZXh0RGlyZWN0aXZlO1xuXG4gIHB1YmxpYyBzdGF0dXNJY29uITogc3RyaW5nO1xuICBwdWJsaWMgc3RhdHVzTWVzc2FnZSE6IFBvbHltb3JwaENvbnRlbnQgfCBudWxsO1xuXG4gIEBIb3N0QmluZGluZygnY2xhc3MuZGlzYWJsZWQnKSBnZXQgZGlzYWJsZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMubGV0RGlyZWN0aXZlPy5jb250ZXh0Py5kaXNhYmxlZDtcbiAgfVxuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmVuYWJsZWQnKSBnZXQgZW5hYmxlZCgpIHtcbiAgICByZXR1cm4gIXRoaXMubGV0RGlyZWN0aXZlPy5jb250ZXh0Py5kaXNhYmxlZDtcbiAgfVxuICBwcml2YXRlIHJlYWRvbmx5IGlubmVyQ2xpY2skJCA9IG5ldyBTdWJqZWN0PE1vdXNlRXZlbnQ+KCk7XG4gIHB1YmxpYyByZWFkb25seSBpbm5lckNsaWNrJCA9IHRoaXMuaW5uZXJDbGljayQkLmFzT2JzZXJ2YWJsZSgpO1xuXG4gIHB1YmxpYyByZWFkb25seSBjZHI6IENoYW5nZURldGVjdG9yUmVmID0gdGhpcy5pbmplY3Rvci5nZXQoQ2hhbmdlRGV0ZWN0b3JSZWYpO1xuICBwcml2YXRlIHJlYWRvbmx5IGRlc3Ryb3kkOiBQcml6bURlc3Ryb3lTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoUHJpem1EZXN0cm95U2VydmljZSk7XG5cbiAgcHJpdmF0ZSBmb3VuZFN0YXR1c0RpcmVjdGl2ZSE6IFByaXptSW5wdXRTdGF0dXNUZXh0RGlyZWN0aXZlO1xuICBwdWJsaWMgcmVhZG9ubHkgY2hhbmdlcyQgPSBuZXcgU3ViamVjdDx2b2lkPigpO1xuICBnZXQgY29ycmVjdGVkU3RhdHVzKCkge1xuICAgIHJldHVybiB0aGlzLmZvdW5kU3RhdHVzRGlyZWN0aXZlPy5zdGF0dXMgJiYgdGhpcy5mb3VuZFN0YXR1c0RpcmVjdGl2ZS5lbmFibGVcbiAgICAgID8gdGhpcy5mb3VuZFN0YXR1c0RpcmVjdGl2ZS5zdGF0dXNcbiAgICAgIDogdGhpcy5zdGF0dXM7XG4gIH1cblxuICBnZXQgZW1wdHlMYWJlbCgpIHtcbiAgICByZXR1cm4gIXRoaXMubGFiZWw/LnJlcGxhY2UoL1sgXSsvLCAnJyk7XG4gIH1cblxuICBnZXQgc2hvd1N0YXR1c0J1dHRvbigpOiBib29sZWFuIHtcbiAgICByZXR1cm4gQm9vbGVhbihcbiAgICAgIHRoaXMuc3RhdHVzICE9PSAnZGVmYXVsdCcgfHxcbiAgICAgICAgKHRoaXMubGV0RGlyZWN0aXZlPy5jb250ZXh0Py5pbnZhbGlkICYmIHRoaXMubGV0RGlyZWN0aXZlPy5jb250ZXh0Py50b3VjaGVkKVxuICAgICk7XG4gIH1cblxuICByZWFkb25seSBvbkNsZWFyQ2xpY2sgPSAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICB0aGlzLmNsZWFyLm5leHQoZXZlbnQpO1xuICAgIHRoaXMuY29udHJvbC5jbGVhcihldmVudCk7XG4gICAgdGhpcy5hY3R1YWxpemVTdGF0dXNJY29uKCk7XG4gIH07XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBpbmplY3RvcjogSW5qZWN0b3IsIHB1YmxpYyByZWFkb25seSBlbDogRWxlbWVudFJlZjxIVE1MRWxlbWVudD4pIHtcbiAgICBzdXBlcigpO1xuICB9XG5cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgdGhpcy5jb250cm9sLnN0YXRlQ2hhbmdlc1xuICAgICAgLnBpcGUoXG4gICAgICAgIGRlYm91bmNlVGltZSgxMCksXG4gICAgICAgIHRhcCgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5hY3R1YWxpemVTdGF0dXNJY29uKCk7XG4gICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xuICAgICAgICB9KSxcbiAgICAgICAgdGFrZVVudGlsKHRoaXMuZGVzdHJveSQpXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKCk7XG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XG4gICAgdGhpcy5hY3R1YWxpemVTdGF0dXNJY29uKCk7XG5cbiAgICBpZiAodGhpcy5jb250cm9sLmRlZmF1bHRMYWJlbCAmJiBDb21wYXJlLmlzTnVsbGlzaCh0aGlzLmxhYmVsKSkge1xuICAgICAgdGhpcy5sYWJlbCQubmV4dCh0aGlzLmNvbnRyb2wuZGVmYXVsdExhYmVsKTtcbiAgICB9XG5cbiAgICBtZXJnZSh0aGlzLmlucHV0U3RhdHVzVGV4dCA/IHRoaXMuaW5wdXRTdGF0dXNUZXh0LmNoYW5nZWQucGlwZShtYXAoKCkgPT4gdGhpcy5pbnB1dFN0YXR1c1RleHQpKSA6IEVNUFRZKVxuICAgICAgLnBpcGUoXG4gICAgICAgIHN0YXJ0V2l0aCh0aGlzLmlucHV0U3RhdHVzVGV4dCksXG4gICAgICAgIG1hcChpID0+IGkgPz8gdGhpcy5jb250cm9sLnN0YXR1c1RleHQpLFxuICAgICAgICBmaWx0ZXJUcnV0aHkoKSxcbiAgICAgICAgdGFwKHRleHQgPT4ge1xuICAgICAgICAgIHRoaXMuZm91bmRTdGF0dXNEaXJlY3RpdmUgPSB0ZXh0O1xuICAgICAgICAgIHRoaXMuc3RhdHVzTWVzc2FnZSA9IHRleHQuZ2V0U3RhdHVzTWVzc2FnZSgpO1xuICAgICAgICAgIHRoaXMuYWN0dWFsaXplU3RhdHVzSWNvbigpO1xuICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcbiAgICAgICAgfSksXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKVxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgpO1xuXG4gICAgLy8gTkVFRCBmb3IgZ2V0IHZpZXcgY2hpbGRyZW4gZnJvbSBuZXN0ZWQgY29udHJvbGxcbiAgICB0aW1lcigwKVxuICAgICAgLnBpcGUoXG4gICAgICAgIHRhcCgoKSA9PiB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKSksXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKVxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgpO1xuICB9XG5cbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xuICAgIGlmIChjaGFuZ2VzLnN0YXR1cykge1xuICAgICAgdGhpcy5hY3R1YWxpemVTdGF0dXNJY29uKCk7XG4gICAgfVxuICAgIHRoaXMuY2hhbmdlcyQubmV4dCgpO1xuICB9XG5cbiAgcHJpdmF0ZSBhY3R1YWxpemVTdGF0dXNJY29uKCk6IHZvaWQge1xuICAgIGxldCBzdGF0dXNJY29uOiBzdHJpbmc7XG5cbiAgICBzd2l0Y2ggKHRoaXMuY29ycmVjdGVkU3RhdHVzKSB7XG4gICAgICBjYXNlICd3YXJuaW5nJzpcbiAgICAgICAgc3RhdHVzSWNvbiA9ICdhbGVydHMtd2FybmluZyc7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdzdWNjZXNzJzpcbiAgICAgICAgc3RhdHVzSWNvbiA9ICdzdWNjZXNzLWNpcmNsZS1maWxsJztcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ2Rhbmdlcic6XG4gICAgICAgIHN0YXR1c0ljb24gPSAnYWxlcnRzLWluZm8tY2lyY2xlLWZpbGwnO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnZGVmYXVsdCc6XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICBpZiAodGhpcy5jb250cm9sLmludmFsaWQpIHtcbiAgICAgIHN0YXR1c0ljb24gPSAnYWxlcnRzLWluZm8tY2lyY2xlLWZpbGwnO1xuICAgIH1cblxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXRzLWNvbW1lbnRcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgdGhpcy5zdGF0dXNJY29uID0gc3RhdHVzSWNvbjtcbiAgfVxuXG4gIHByb3RlY3RlZCBpbm5lckNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgdGhpcy5pbm5lckNsaWNrJCQubmV4dChldmVudCk7XG4gIH1cbn1cbiIsIjxuZy1jb250YWluZXJcbiAgKnByaXptTGV0PVwie1xuICAgIGZvY3VzZWQ6IGNvbnRyb2wuZm9jdXNlZCB8IHByaXptVG9PYnNlcnZhYmxlIHwgYXN5bmMsXG4gICAgZGlzYWJsZWQ6IGNvbnRyb2wuZGlzYWJsZWQgfCBwcml6bVRvT2JzZXJ2YWJsZSB8IGFzeW5jLFxuICAgIGVtcHR5OiBjb250cm9sLmVtcHR5IHwgcHJpem1Ub09ic2VydmFibGUgfCBhc3luYyxcbiAgICB0b3VjaGVkOiBjb250cm9sLnRvdWNoZWQgfCBwcml6bVRvT2JzZXJ2YWJsZSB8IGFzeW5jLFxuICAgIGludmFsaWQ6IGNvbnRyb2wuaW52YWxpZCB8IHByaXptVG9PYnNlcnZhYmxlIHwgYXN5bmMsXG4gICAgcmVxdWlyZWQ6IGNvbnRyb2wucmVxdWlyZWQgfCBwcml6bVRvT2JzZXJ2YWJsZSB8IGFzeW5jLFxuICAgIGVtcHR5TGFiZWw6IGVtcHR5TGFiZWxcbiAgfSBhcyAkXCJcbj5cbiAgPG5nLXRlbXBsYXRlICNsYWJlbFRlbXBsYXRlPlxuICAgIDxkaXZcbiAgICAgIGNsYXNzPVwibGFiZWwtY29udGFpbmVyXCJcbiAgICAgICpuZ0lmPVwibGFiZWwkIHwgYXN5bmNcIlxuICAgICAgW25nQ2xhc3NdPVwiW1xuICAgICAgICBjb250cm9sLm5hdGl2ZUVsZW1lbnRUeXBlID8gJ2xhYmVsLWNvbnRhaW5lci0nICsgY29udHJvbC5uYXRpdmVFbGVtZW50VHlwZSA6ICcnLFxuICAgICAgICAnbGFiZWwtY29udGFpbmVyLScgKyAob3V0ZXIgPyAnb3V0ZXInIDogJ2lubmVyJylcbiAgICAgIF1cIlxuICAgICAgW2NsYXNzLmxhYmVsLWNvbnRhaW5lci1mb2N1c2VkXT1cIiQuZm9jdXNlZFwiXG4gICAgICBbYXR0ci5kYXRhLXNpemVdPVwic2l6ZVwiXG4gICAgPlxuICAgICAgPGxhYmVsXG4gICAgICAgIGNsYXNzPVwicHJpem0taW5wdXQtbGFiZWxcbiAgICBwcml6bS1pbnB1dC1sYWJlbC17eyBvdXRlciA/ICdvdXRlcicgOiAnaW5uZXInIH19XG4gICAgcHJpem0taW5wdXQtbGFiZWwte3sgb3V0ZXIgPyAnb3V0ZXInIDogJ2lubmVyJyB9fS17eyBwb3NpdGlvbiB9fVxuICAgIHt7IGNvbnRyb2wubmF0aXZlRWxlbWVudFR5cGUgPyAncHJpem0taW5wdXQtbGFiZWwtJyArIGNvbnRyb2wubmF0aXZlRWxlbWVudFR5cGUgOiAnJyB9fVxuXCJcbiAgICAgICAgW2F0dHIuZGF0YS1zaXplXT1cInNpemVcIlxuICAgICAgICBbY2xhc3MucHJpem0taW5wdXQtbGFiZWwtZm9jdXNlZF09XCIkLmZvY3VzZWRcIlxuICAgICAgICBbY2xhc3MucHJpem0taW5wdXQtbGFiZWwtZW1wdHldPVwiJC5lbXB0eVwiXG4gICAgICA+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJsYWJlbC0tdGl0bGVcIj5cbiAgICAgICAgICB7eyBsYWJlbCQgfCBhc3luYyB9fVxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPHNwYW4gY2xhc3M9XCJwcml6bS1pbnB1dC1sYWJlbC1yZXF1aXJlZFwiICpuZ0lmPVwiJC5yZXF1aXJlZFwiPio8L3NwYW4+XG4gICAgICA8L2xhYmVsPlxuXG4gICAgICA8bmctY29udGFpbmVyIFtuZ1N3aXRjaF09XCJpc1BvbHltb3JwaFByaW1pdGl2ZShjbGVhckJ1dHRvbilcIj5cbiAgICAgICAgPGJ1dHRvblxuICAgICAgICAgIGNsYXNzPVwicHJpem0taW5wdXQtbGFiZWwtY2xlYXItYnRuIGNsZWFyLWljb25cIlxuICAgICAgICAgICpuZ1N3aXRjaENhc2U9XCJ0cnVlXCJcbiAgICAgICAgICBbaW50ZXJhY3RpdmVdPVwidHJ1ZVwiXG4gICAgICAgICAgW2Rpc2FibGVkXT1cIiQuZGlzYWJsZWRcIlxuICAgICAgICAgIFtwcml6bUlucHV0SWNvbkJ1dHRvbl09XCIkYW55KGNsZWFyQnV0dG9uKVwiXG4gICAgICAgICAgKGNsaWNrKT1cIm9uQ2xlYXJDbGljaygkZXZlbnQpXCJcbiAgICAgICAgPjwvYnV0dG9uPlxuXG4gICAgICAgIDxkaXYgY2xhc3M9XCJwcml6bS1pbnB1dC1sYWJlbC1jbGVhci1idG4gY2xlYXItaWNvblwiICpuZ1N3aXRjaERlZmF1bHQ+XG4gICAgICAgICAgPG5nLWNvbnRhaW5lclxuICAgICAgICAgICAgKnBvbHltb3JwaE91dGxldD1cIlxuICAgICAgICAgICAgICBjbGVhckJ1dHRvbjtcbiAgICAgICAgICAgICAgY29udGV4dDogeyBjbGVhcjogb25DbGVhckNsaWNrLCBzaG93U3RhdHVzQnV0dG9uOiBzaG93U3RhdHVzQnV0dG9uLCBkaXNhYmxlZDogJC5kaXNhYmxlZCB9XG4gICAgICAgICAgICBcIlxuICAgICAgICAgID5cbiAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICA8L2Rpdj5cbiAgPC9uZy10ZW1wbGF0ZT5cblxuICA8bmctY29udGFpbmVyICpuZ0lmPVwiIW91dGVyOyBlbHNlIGxhYmVsVGVtcGxhdGVcIj48L25nLWNvbnRhaW5lcj5cblxuICA8ZGl2XG4gICAgY2xhc3M9XCJwcml6bS1pbnB1dC1mb3JtXG4gIHByaXptLWlucHV0LWZvcm0tc3RhdHVzLXt7IGNvcnJlY3RlZFN0YXR1cyB9fVxuICBwcml6bS1pbnB1dC1mb3JtLXt7IG91dGVyID8gJ291dGVyJyA6ICdpbm5lcicgfX1cbiAgcHJpem0taW5wdXQtZm9ybS17eyBwb3NpdGlvbiB9fVxuICBwcml6bS1pbnB1dC1mb3JtLXt7IG91dGVyID8gJ291dGVyJyA6ICdpbm5lcicgfX0te3sgcG9zaXRpb24gfX1cbiAge3sgY29udHJvbC5uYXRpdmVFbGVtZW50VHlwZSA/ICdwcml6bS1pbnB1dC1mb3JtLScgKyBjb250cm9sLm5hdGl2ZUVsZW1lbnRUeXBlIDogJycgfX1cblwiXG4gICAgW2NsYXNzLmhpZGUtYm9yZGVyXT1cIiFib3JkZXJcIlxuICAgIFthdHRyLmRhdGEtc2l6ZV09XCJzaXplXCJcbiAgICBbbmdDbGFzc109XCJ7XG4gICAgICAncHJpem0taW5wdXQtZm9ybS1mb2N1c2VkJzogISQuZGlzYWJsZWQgJiYgJC5mb2N1c2VkLFxuICAgICAgJ3ByaXptLWlucHV0LWZvcm0tZW1wdHknOiAkLmVtcHR5LFxuICAgICAgJ3ByaXptLWlucHV0LWVtcHR5LWxhYmVsJzogZW1wdHlMYWJlbCxcbiAgICAgICdwcml6bS1pbnB1dC1mb3JtLWRpc2FibGVkJzogJC5kaXNhYmxlZCxcbiAgICAgICdwcml6bS1pbnB1dC1mb3JtLXRvdWNoZWQnOiAkLnRvdWNoZWQsXG4gICAgICAncHJpem0taW5wdXQtZm9ybS1pbnZhbGlkJzogJC5pbnZhbGlkXG4gICAgfVwiXG4gID5cbiAgICA8ZGl2IGNsYXNzPVwicHJpem0taW5wdXQtZm9ybV9fZmlyc3RcIj5cbiAgICAgIDxuZy1jb250YWluZXI+XG4gICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJjb250cm9sLmxheW91dExlZnQ/LnRlbXBsYXRlUmVmIGFzIHRlbXBsYXRlXCIgW25nVGVtcGxhdGVPdXRsZXRdPVwidGVtcGxhdGVcIj5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgIDxuZy1jb250ZW50IHNlbGVjdD1cIltwcml6bS1pbnB1dC1sZWZ0XVwiPjwvbmctY29udGVudD5cbiAgICAgIDwvbmctY29udGFpbmVyPlxuXG4gICAgICA8ZGl2IGNsYXNzPVwicHJpem0taW5wdXQtZm9ybS1pbm5lci1jb250YWluZXJcIiAoY2xpY2spPVwiaW5uZXJDbGljaygkZXZlbnQpXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJwcml6bS1pbnB1dC1mb3JtLWJvZHlcIj5cbiAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwib3V0ZXI7IGVsc2UgbGFiZWxUZW1wbGF0ZVwiPjwvbmctY29udGFpbmVyPlxuXG4gICAgICAgICAgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxuICAgICAgICAgIDxuZy1jb250YWluZXI+XG4gICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiY29udHJvbC5sYXlvdXRJbkJvZHk/LnRlbXBsYXRlUmVmIGFzIHRlbXBsYXRlXCIgW25nVGVtcGxhdGVPdXRsZXRdPVwidGVtcGxhdGVcIj5cbiAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgPG5nLWNvbnRlbnQgc2VsZWN0PVwiW3ByaXptLWlucHV0LWluLWJvZHldXCI+PC9uZy1jb250ZW50PlxuICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwic2hvd0NsZWFyQnV0dG9uXCIgW25nU3dpdGNoXT1cImlzUG9seW1vcnBoUHJpbWl0aXZlKGNsZWFyQnV0dG9uKVwiPlxuICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgIGNsYXNzPVwicHJpem0taW5wdXQtbGFiZWwtY2xlYXItYnRuIHByaXptLWlucHV0LWJ1dHRvbi1kZWZhdWx0IGNsZWFyLWljb25cIlxuICAgICAgICAgICAgKm5nU3dpdGNoQ2FzZT1cInRydWVcIlxuICAgICAgICAgICAgW2ludGVyYWN0aXZlXT1cInRydWVcIlxuICAgICAgICAgICAgW2Rpc2FibGVkXT1cIiQuZGlzYWJsZWRcIlxuICAgICAgICAgICAgW3ByaXptSW5wdXRJY29uQnV0dG9uXT1cIiRhbnkoY2xlYXJCdXR0b24pID8/ICdjYW5jZWwtZGVsZXRlLWNvbnRlbnQnXCJcbiAgICAgICAgICAgIChjbGljayk9XCJvbkNsZWFyQ2xpY2soJGV2ZW50KVwiXG4gICAgICAgICAgPjwvYnV0dG9uPlxuXG4gICAgICAgICAgPGRpdiBjbGFzcz1cInByaXptLWlucHV0LWJ1dHRvbi1kZWZhdWx0IGNsZWFyLWljb25cIiAqbmdTd2l0Y2hEZWZhdWx0PlxuICAgICAgICAgICAgPG5nLWNvbnRhaW5lclxuICAgICAgICAgICAgICAqcG9seW1vcnBoT3V0bGV0PVwiXG4gICAgICAgICAgICAgICAgY2xlYXJCdXR0b247XG4gICAgICAgICAgICAgICAgY29udGV4dDogeyBjbGVhcjogb25DbGVhckNsaWNrLCBzaG93U3RhdHVzQnV0dG9uOiBzaG93U3RhdHVzQnV0dG9uLCBkaXNhYmxlZDogJC5kaXNhYmxlZCB9XG4gICAgICAgICAgICAgIFwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgPGJ1dHRvblxuICAgICAgICAgIGNsYXNzPVwicHJpem0taW5wdXQtZm9ybS1zdGF0dXMtYnV0dG9uXCJcbiAgICAgICAgICAjc3RhdHVzQnV0dG9uXG4gICAgICAgICAgKm5nSWY9XCJzaG93U3RhdHVzQnV0dG9uXCJcbiAgICAgICAgICBbcHJpem1JbnB1dEljb25CdXR0b25dPVwic3RhdHVzSWNvblwiXG4gICAgICAgICAgW3ByaXptSGludF09XCJzdGF0dXNNZXNzYWdlXCJcbiAgICAgICAgICBbcHJpem1IaW50Q2FuU2hvd109XCIhIXN0YXR1c01lc3NhZ2VcIlxuICAgICAgICAgIFtpbnRlcmFjdGl2ZV09XCJmYWxzZVwiXG4gICAgICAgID48L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuXG4gICAgICA8bmctY29udGFpbmVyPlxuICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiY29udHJvbC5sYXlvdXRSaWdodD8udGVtcGxhdGVSZWYgYXMgdGVtcGxhdGVcIiBbbmdUZW1wbGF0ZU91dGxldF09XCJ0ZW1wbGF0ZVwiPlxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgPG5nLWNvbnRlbnQgc2VsZWN0PVwiW3ByaXptLWlucHV0LXJpZ2h0XVwiPjwvbmctY29udGVudD5cbiAgICAgIDwvbmctY29udGFpbmVyPlxuICAgIDwvZGl2PlxuXG4gICAgPG5nLWNvbnRhaW5lcj5cbiAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJjb250cm9sLmxheW91dEJvdHRvbT8udGVtcGxhdGVSZWYgYXMgdGVtcGxhdGVcIiBbbmdUZW1wbGF0ZU91dGxldF09XCJ0ZW1wbGF0ZVwiPlxuICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICA8bmctY29udGVudCBzZWxlY3Q9XCJbcHJpem0taW5wdXQtYm90dG9tXVwiPjwvbmctY29udGVudD5cbiAgICA8L25nLWNvbnRhaW5lcj5cbiAgPC9kaXY+XG5cbiAgPGRpdiBjbGFzcz1cInByaXptLWlucHV0LWZvcm0tc3VidGV4dCBwcml6bS1pbnB1dC1mb3JtLXN1YnRleHQte3sgY29ycmVjdGVkU3RhdHVzIH19XCI+XG4gICAgPG5nLWNvbnRhaW5lcj5cbiAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJjb250cm9sLmxheW91dFN1YnRleHQ/LnRlbXBsYXRlUmVmIGFzIHRlbXBsYXRlXCIgW25nVGVtcGxhdGVPdXRsZXRdPVwidGVtcGxhdGVcIj5cbiAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgPG5nLWNvbnRlbnQgc2VsZWN0PVwiW3ByaXptLWlucHV0LXN1YnRleHRdXCI+PC9uZy1jb250ZW50PlxuICAgIDwvbmctY29udGFpbmVyPlxuICA8L2Rpdj5cbjwvbmctY29udGFpbmVyPlxuIl19