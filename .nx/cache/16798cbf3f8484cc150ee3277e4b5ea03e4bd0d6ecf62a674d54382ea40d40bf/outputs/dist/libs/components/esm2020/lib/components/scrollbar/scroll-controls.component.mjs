import { AsyncPipe, DOCUMENT, NgIf } from '@angular/common';
import { ChangeDetectionStrategy, Component, Inject, NgZone, Optional } from '@angular/core';
import { ANIMATION_FRAME } from '@ng-web-apis/common';
import { Observable } from 'rxjs';
import { distinctUntilChanged, map, startWith, throttleTime } from 'rxjs/operators';
import { prizmFadeIn } from '../../animations';
import { prizmZoneOptimized } from '../../observables';
import { PRIZM_ANIMATION_OPTIONS, PRIZM_SCROLL_REF } from '../../tokens';
import { PrizmAbstractTestId } from '../../abstract/interactive';
import { PrizmLetDirective } from '@prizm-ui/helpers';
import { PrizmThemeModule } from '@prizm-ui/theme';
import { PrizmScrollbarWrapperDirective } from './scrollbar-wrapper.directive';
import { PrizmScrollbarDirective } from './scrollbar.directive';
import * as i0 from "@angular/core";
import * as i1 from "@prizm-ui/theme";
import * as i2 from "rxjs";
export class PrizmScrollControlsComponent extends PrizmAbstractTestId {
    constructor(options, ngZone, documentRef, scrollRef, animationFrame$) {
        super();
        this.options = options;
        this.ngZone = ngZone;
        this.documentRef = documentRef;
        this.scrollRef = scrollRef;
        this.animationFrame$ = animationFrame$;
        this.testId_ = 'ui_scroll_controls';
        this.refresh$ = this.animationFrame$.pipe(throttleTime(300), map(() => this.scrollbars), startWith([false, false]), distinctUntilChanged((a, b) => a[0] === b[0] && a[1] === b[1]), prizmZoneOptimized(this.ngZone));
        this.animation = {
            value: '',
            ...this.options,
        };
    }
    get scrollbars() {
        const { clientHeight, scrollHeight, clientWidth, scrollWidth } = this.scrollRef
            ? this.scrollRef.nativeElement
            : this.documentRef.documentElement;
        return [
            Math.ceil((clientHeight / scrollHeight) * 100) < 100,
            Math.ceil((clientWidth / scrollWidth) * 100) < 100,
        ];
    }
}
PrizmScrollControlsComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: PrizmScrollControlsComponent, deps: [{ token: PRIZM_ANIMATION_OPTIONS }, { token: NgZone }, { token: DOCUMENT }, { token: PRIZM_SCROLL_REF, optional: true }, { token: ANIMATION_FRAME }], target: i0.ɵɵFactoryTarget.Component });
PrizmScrollControlsComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.9", type: PrizmScrollControlsComponent, isStandalone: true, selector: "prizm-scroll-controls", usesInheritance: true, ngImport: i0, template: "<ng-container *prizmLet=\"refresh$ | async as bars\">\n  <div\n    class=\"bar bar_vertical\"\n    *ngIf=\"bars[0]\"\n    [@prizmFadeIn]=\"animation\"\n    [class.bar_has-horizontal]=\"bars[1]\"\n    prizmScrollbarWrapper\n  >\n    <div class=\"thumb\" prizmScrollbar=\"vertical\" prizmTheme></div>\n  </div>\n  <div\n    class=\"bar bar_horizontal\"\n    *ngIf=\"bars[1]\"\n    [@prizmFadeIn]=\"animation\"\n    [class.bar_has-vertical]=\"bars[0]\"\n    prizmScrollbarWrapper\n  >\n    <div class=\"thumb\" prizmScrollbar=\"horizontal\" prizmTheme></div>\n  </div>\n</ng-container>\n", styles: [":host{position:sticky;top:0;left:0;z-index:1;min-width:calc(100% - 1px);min-height:calc(100% - 1px);float:left;margin-right:calc(-100% + 1px);margin-inline-start:0;margin-inline-end:calc(-100% + 1px);pointer-events:none}.bar{position:absolute;right:0;bottom:0;pointer-events:auto}.bar_vertical{top:0;width:14px}.bar_horizontal{left:0;height:14px}.bar_has-horizontal{bottom:11.75px}.bar_has-vertical{right:11.75px}.thumb{transition-property:all;transition-duration:.15s;transition-timing-function:ease-in-out;position:absolute;border-radius:var(--prizm-scrollbar-thumb-border-radius, 8px);border:var(--prizm-scrollbar-thumb-border, 4px solid transparent);cursor:pointer;pointer-events:auto;background:var(--prizm-scrollbar-thumb-color, var(--prizm-v3-form-stroke-default));background-clip:content-box;opacity:var(--prizm-scrollbar-thumb-opacity, .8);box-sizing:border-box;transition-property:width,height}.thumb[data-prizm-theme=dark]{background-color:var(--prizm-v3-form-stroke-default)}.thumb:hover{opacity:var(--prizm-scrollbar-thumb-opacity-hover, .9)}.thumb:active{opacity:var(--prizm-scrollbar-thumb-opacity-active, 1)}.bar_vertical .thumb{right:0;width:var(--prizm-scrollbar-thumb-width, 12px);min-height:var(--prizm-scrollbar-thumb-width, 18px)}.bar_vertical:hover .thumb,.bar_vertical .thumb:active{width:var(--prizm-scrollbar-thumb-width-large, 14px)}.bar_horizontal .thumb{bottom:0;height:var(--prizm-scrollbar-thumb-width, 12px);min-width:var(--prizm-scrollbar-thumb-width, 18px)}.bar_horizontal:hover .thumb,.bar_horizontal .thumb:active{height:var(--prizm-scrollbar-thumb-width-large, 14px)}\n"], dependencies: [{ kind: "directive", type: NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "pipe", type: AsyncPipe, name: "async" }, { kind: "directive", type: PrizmLetDirective, selector: "[prizmLet]", inputs: ["prizmLet"], exportAs: ["prizmLet"] }, { kind: "ngmodule", type: PrizmThemeModule }, { kind: "directive", type: i1.PrizmThemeDirective, selector: "[prizmTheme]", inputs: ["prizmTheme"], outputs: ["prizmThemeChange"] }, { kind: "directive", type: PrizmScrollbarWrapperDirective, selector: "[prizmScrollbarWrapper]" }, { kind: "directive", type: PrizmScrollbarDirective, selector: "[prizmScrollbar]", inputs: ["prizmScrollbar"] }], animations: [prizmFadeIn], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: PrizmScrollControlsComponent, decorators: [{
            type: Component,
            args: [{ selector: 'prizm-scroll-controls', changeDetection: ChangeDetectionStrategy.OnPush, animations: [prizmFadeIn], standalone: true, imports: [
                        NgIf,
                        AsyncPipe,
                        PrizmLetDirective,
                        PrizmThemeModule,
                        PrizmScrollbarWrapperDirective,
                        PrizmScrollbarDirective,
                    ], template: "<ng-container *prizmLet=\"refresh$ | async as bars\">\n  <div\n    class=\"bar bar_vertical\"\n    *ngIf=\"bars[0]\"\n    [@prizmFadeIn]=\"animation\"\n    [class.bar_has-horizontal]=\"bars[1]\"\n    prizmScrollbarWrapper\n  >\n    <div class=\"thumb\" prizmScrollbar=\"vertical\" prizmTheme></div>\n  </div>\n  <div\n    class=\"bar bar_horizontal\"\n    *ngIf=\"bars[1]\"\n    [@prizmFadeIn]=\"animation\"\n    [class.bar_has-vertical]=\"bars[0]\"\n    prizmScrollbarWrapper\n  >\n    <div class=\"thumb\" prizmScrollbar=\"horizontal\" prizmTheme></div>\n  </div>\n</ng-container>\n", styles: [":host{position:sticky;top:0;left:0;z-index:1;min-width:calc(100% - 1px);min-height:calc(100% - 1px);float:left;margin-right:calc(-100% + 1px);margin-inline-start:0;margin-inline-end:calc(-100% + 1px);pointer-events:none}.bar{position:absolute;right:0;bottom:0;pointer-events:auto}.bar_vertical{top:0;width:14px}.bar_horizontal{left:0;height:14px}.bar_has-horizontal{bottom:11.75px}.bar_has-vertical{right:11.75px}.thumb{transition-property:all;transition-duration:.15s;transition-timing-function:ease-in-out;position:absolute;border-radius:var(--prizm-scrollbar-thumb-border-radius, 8px);border:var(--prizm-scrollbar-thumb-border, 4px solid transparent);cursor:pointer;pointer-events:auto;background:var(--prizm-scrollbar-thumb-color, var(--prizm-v3-form-stroke-default));background-clip:content-box;opacity:var(--prizm-scrollbar-thumb-opacity, .8);box-sizing:border-box;transition-property:width,height}.thumb[data-prizm-theme=dark]{background-color:var(--prizm-v3-form-stroke-default)}.thumb:hover{opacity:var(--prizm-scrollbar-thumb-opacity-hover, .9)}.thumb:active{opacity:var(--prizm-scrollbar-thumb-opacity-active, 1)}.bar_vertical .thumb{right:0;width:var(--prizm-scrollbar-thumb-width, 12px);min-height:var(--prizm-scrollbar-thumb-width, 18px)}.bar_vertical:hover .thumb,.bar_vertical .thumb:active{width:var(--prizm-scrollbar-thumb-width-large, 14px)}.bar_horizontal .thumb{bottom:0;height:var(--prizm-scrollbar-thumb-width, 12px);min-width:var(--prizm-scrollbar-thumb-width, 18px)}.bar_horizontal:hover .thumb,.bar_horizontal .thumb:active{height:var(--prizm-scrollbar-thumb-width-large, 14px)}\n"] }]
        }], ctorParameters: function () { return [{ type: undefined, decorators: [{
                    type: Inject,
                    args: [PRIZM_ANIMATION_OPTIONS]
                }] }, { type: i0.NgZone, decorators: [{
                    type: Inject,
                    args: [NgZone]
                }] }, { type: Document, decorators: [{
                    type: Inject,
                    args: [DOCUMENT]
                }] }, { type: i0.ElementRef, decorators: [{
                    type: Optional
                }, {
                    type: Inject,
                    args: [PRIZM_SCROLL_REF]
                }] }, { type: i2.Observable, decorators: [{
                    type: Inject,
                    args: [ANIMATION_FRAME]
                }] }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2Nyb2xsLWNvbnRyb2xzLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2xpYnMvY29tcG9uZW50cy9zcmMvbGliL2NvbXBvbmVudHMvc2Nyb2xsYmFyL3Njcm9sbC1jb250cm9scy5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL2NvbXBvbmVudHMvc3JjL2xpYi9jb21wb25lbnRzL3Njcm9sbGJhci9zY3JvbGwtY29udHJvbHMuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDNUQsT0FBTyxFQUFFLHVCQUF1QixFQUFFLFNBQVMsRUFBYyxNQUFNLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN6RyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUNsQyxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsR0FBRyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUNwRixPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDL0MsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDdkQsT0FBTyxFQUFFLHVCQUF1QixFQUFFLGdCQUFnQixFQUFFLE1BQU0sY0FBYyxDQUFDO0FBRXpFLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ2pFLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ3RELE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ25ELE9BQU8sRUFBRSw4QkFBOEIsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQy9FLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLHVCQUF1QixDQUFDOzs7O0FBa0JoRSxNQUFNLE9BQU8sNEJBQTZCLFNBQVEsbUJBQW1CO0lBZ0JuRSxZQUNvRCxPQUF5QixFQUMxQyxNQUFjLEVBQ1osV0FBcUIsRUFHdkMsU0FBeUMsRUFDaEIsZUFBbUM7UUFFN0UsS0FBSyxFQUFFLENBQUM7UUFSMEMsWUFBTyxHQUFQLE9BQU8sQ0FBa0I7UUFDMUMsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQUNaLGdCQUFXLEdBQVgsV0FBVyxDQUFVO1FBR3ZDLGNBQVMsR0FBVCxTQUFTLENBQWdDO1FBQ2hCLG9CQUFlLEdBQWYsZUFBZSxDQUFvQjtRQXRCN0QsWUFBTyxHQUFHLG9CQUFvQixDQUFDO1FBRXhDLGFBQVEsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FDM0MsWUFBWSxDQUFDLEdBQUcsQ0FBQyxFQUNqQixHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUMxQixTQUFTLENBQUMsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUMsRUFDekIsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFDOUQsa0JBQWtCLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUNoQyxDQUFDO1FBRU8sY0FBUyxHQUFHO1lBQ25CLEtBQUssRUFBRSxFQUFFO1lBQ1QsR0FBRyxJQUFJLENBQUMsT0FBTztTQUNQLENBQUM7SUFZWCxDQUFDO0lBRUQsSUFBWSxVQUFVO1FBQ3BCLE1BQU0sRUFBRSxZQUFZLEVBQUUsWUFBWSxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsR0FBRyxJQUFJLENBQUMsU0FBUztZQUM3RSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhO1lBQzlCLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLGVBQWUsQ0FBQztRQUVyQyxPQUFPO1lBQ0wsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLFlBQVksR0FBRyxZQUFZLENBQUMsR0FBRyxHQUFHLENBQUMsR0FBRyxHQUFHO1lBQ3BELElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDLEdBQUcsR0FBRyxDQUFDLEdBQUcsR0FBRztTQUNuRCxDQUFDO0lBQ0osQ0FBQzs7eUhBckNVLDRCQUE0QixrQkFpQjdCLHVCQUF1QixhQUN2QixNQUFNLGFBQ04sUUFBUSxhQUVSLGdCQUFnQiw2QkFFaEIsZUFBZTs2R0F2QmQsNEJBQTRCLHdHQy9CekMsMGtCQW9CQSxnb0RER0ksSUFBSSx3RkFDSixTQUFTLDhDQUNULGlCQUFpQixvR0FDakIsZ0JBQWdCLHFLQUNoQiw4QkFBOEIsb0VBQzlCLHVCQUF1QiwyRUFSYixDQUFDLFdBQVcsQ0FBQzsyRkFXZCw0QkFBNEI7a0JBaEJ4QyxTQUFTOytCQUNFLHVCQUF1QixtQkFHaEIsdUJBQXVCLENBQUMsTUFBTSxjQUNuQyxDQUFDLFdBQVcsQ0FBQyxjQUNiLElBQUksV0FDUDt3QkFDUCxJQUFJO3dCQUNKLFNBQVM7d0JBQ1QsaUJBQWlCO3dCQUNqQixnQkFBZ0I7d0JBQ2hCLDhCQUE4Qjt3QkFDOUIsdUJBQXVCO3FCQUN4Qjs7MEJBbUJFLE1BQU07MkJBQUMsdUJBQXVCOzswQkFDOUIsTUFBTTsyQkFBQyxNQUFNOzswQkFDYixNQUFNOzJCQUFDLFFBQVE7OzBCQUNmLFFBQVE7OzBCQUNSLE1BQU07MkJBQUMsZ0JBQWdCOzswQkFFdkIsTUFBTTsyQkFBQyxlQUFlIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXN5bmNQaXBlLCBET0NVTUVOVCwgTmdJZiB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSwgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBJbmplY3QsIE5nWm9uZSwgT3B0aW9uYWwgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEFOSU1BVElPTl9GUkFNRSB9IGZyb20gJ0BuZy13ZWItYXBpcy9jb21tb24nO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgZGlzdGluY3RVbnRpbENoYW5nZWQsIG1hcCwgc3RhcnRXaXRoLCB0aHJvdHRsZVRpbWUgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBwcml6bUZhZGVJbiB9IGZyb20gJy4uLy4uL2FuaW1hdGlvbnMnO1xuaW1wb3J0IHsgcHJpem1ab25lT3B0aW1pemVkIH0gZnJvbSAnLi4vLi4vb2JzZXJ2YWJsZXMnO1xuaW1wb3J0IHsgUFJJWk1fQU5JTUFUSU9OX09QVElPTlMsIFBSSVpNX1NDUk9MTF9SRUYgfSBmcm9tICcuLi8uLi90b2tlbnMnO1xuaW1wb3J0IHsgQW5pbWF0aW9uT3B0aW9ucyB9IGZyb20gJ0Bhbmd1bGFyL2FuaW1hdGlvbnMnO1xuaW1wb3J0IHsgUHJpem1BYnN0cmFjdFRlc3RJZCB9IGZyb20gJy4uLy4uL2Fic3RyYWN0L2ludGVyYWN0aXZlJztcbmltcG9ydCB7IFByaXptTGV0RGlyZWN0aXZlIH0gZnJvbSAnQHByaXptLXVpL2hlbHBlcnMnO1xuaW1wb3J0IHsgUHJpem1UaGVtZU1vZHVsZSB9IGZyb20gJ0Bwcml6bS11aS90aGVtZSc7XG5pbXBvcnQgeyBQcml6bVNjcm9sbGJhcldyYXBwZXJEaXJlY3RpdmUgfSBmcm9tICcuL3Njcm9sbGJhci13cmFwcGVyLmRpcmVjdGl2ZSc7XG5pbXBvcnQgeyBQcml6bVNjcm9sbGJhckRpcmVjdGl2ZSB9IGZyb20gJy4vc2Nyb2xsYmFyLmRpcmVjdGl2ZSc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3ByaXptLXNjcm9sbC1jb250cm9scycsXG4gIHRlbXBsYXRlVXJsOiAnLi9zY3JvbGwtY29udHJvbHMuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9zY3JvbGwtY29udHJvbHMuY29tcG9uZW50Lmxlc3MnXSxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gIGFuaW1hdGlvbnM6IFtwcml6bUZhZGVJbl0sXG4gIHN0YW5kYWxvbmU6IHRydWUsXG4gIGltcG9ydHM6IFtcbiAgICBOZ0lmLFxuICAgIEFzeW5jUGlwZSxcbiAgICBQcml6bUxldERpcmVjdGl2ZSxcbiAgICBQcml6bVRoZW1lTW9kdWxlLFxuICAgIFByaXptU2Nyb2xsYmFyV3JhcHBlckRpcmVjdGl2ZSxcbiAgICBQcml6bVNjcm9sbGJhckRpcmVjdGl2ZSxcbiAgXSxcbn0pXG5leHBvcnQgY2xhc3MgUHJpem1TY3JvbGxDb250cm9sc0NvbXBvbmVudCBleHRlbmRzIFByaXptQWJzdHJhY3RUZXN0SWQge1xuICBvdmVycmlkZSByZWFkb25seSB0ZXN0SWRfID0gJ3VpX3Njcm9sbF9jb250cm9scyc7XG5cbiAgcmVhZG9ubHkgcmVmcmVzaCQgPSB0aGlzLmFuaW1hdGlvbkZyYW1lJC5waXBlKFxuICAgIHRocm90dGxlVGltZSgzMDApLFxuICAgIG1hcCgoKSA9PiB0aGlzLnNjcm9sbGJhcnMpLFxuICAgIHN0YXJ0V2l0aChbZmFsc2UsIGZhbHNlXSksXG4gICAgZGlzdGluY3RVbnRpbENoYW5nZWQoKGEsIGIpID0+IGFbMF0gPT09IGJbMF0gJiYgYVsxXSA9PT0gYlsxXSksXG4gICAgcHJpem1ab25lT3B0aW1pemVkKHRoaXMubmdab25lKVxuICApO1xuXG4gIHJlYWRvbmx5IGFuaW1hdGlvbiA9IHtcbiAgICB2YWx1ZTogJycsXG4gICAgLi4udGhpcy5vcHRpb25zLFxuICB9IGFzIGNvbnN0O1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIEBJbmplY3QoUFJJWk1fQU5JTUFUSU9OX09QVElPTlMpIHByaXZhdGUgcmVhZG9ubHkgb3B0aW9uczogQW5pbWF0aW9uT3B0aW9ucyxcbiAgICBASW5qZWN0KE5nWm9uZSkgcHJpdmF0ZSByZWFkb25seSBuZ1pvbmU6IE5nWm9uZSxcbiAgICBASW5qZWN0KERPQ1VNRU5UKSBwcml2YXRlIHJlYWRvbmx5IGRvY3VtZW50UmVmOiBEb2N1bWVudCxcbiAgICBAT3B0aW9uYWwoKVxuICAgIEBJbmplY3QoUFJJWk1fU0NST0xMX1JFRilcbiAgICBwcml2YXRlIHJlYWRvbmx5IHNjcm9sbFJlZjogRWxlbWVudFJlZjxIVE1MRWxlbWVudD4gfCBudWxsLFxuICAgIEBJbmplY3QoQU5JTUFUSU9OX0ZSQU1FKSBwcml2YXRlIHJlYWRvbmx5IGFuaW1hdGlvbkZyYW1lJDogT2JzZXJ2YWJsZTxudW1iZXI+XG4gICkge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICBwcml2YXRlIGdldCBzY3JvbGxiYXJzKCk6IFtib29sZWFuLCBib29sZWFuXSB7XG4gICAgY29uc3QgeyBjbGllbnRIZWlnaHQsIHNjcm9sbEhlaWdodCwgY2xpZW50V2lkdGgsIHNjcm9sbFdpZHRoIH0gPSB0aGlzLnNjcm9sbFJlZlxuICAgICAgPyB0aGlzLnNjcm9sbFJlZi5uYXRpdmVFbGVtZW50XG4gICAgICA6IHRoaXMuZG9jdW1lbnRSZWYuZG9jdW1lbnRFbGVtZW50O1xuXG4gICAgcmV0dXJuIFtcbiAgICAgIE1hdGguY2VpbCgoY2xpZW50SGVpZ2h0IC8gc2Nyb2xsSGVpZ2h0KSAqIDEwMCkgPCAxMDAsXG4gICAgICBNYXRoLmNlaWwoKGNsaWVudFdpZHRoIC8gc2Nyb2xsV2lkdGgpICogMTAwKSA8IDEwMCxcbiAgICBdO1xuICB9XG59XG4iLCI8bmctY29udGFpbmVyICpwcml6bUxldD1cInJlZnJlc2gkIHwgYXN5bmMgYXMgYmFyc1wiPlxuICA8ZGl2XG4gICAgY2xhc3M9XCJiYXIgYmFyX3ZlcnRpY2FsXCJcbiAgICAqbmdJZj1cImJhcnNbMF1cIlxuICAgIFtAcHJpem1GYWRlSW5dPVwiYW5pbWF0aW9uXCJcbiAgICBbY2xhc3MuYmFyX2hhcy1ob3Jpem9udGFsXT1cImJhcnNbMV1cIlxuICAgIHByaXptU2Nyb2xsYmFyV3JhcHBlclxuICA+XG4gICAgPGRpdiBjbGFzcz1cInRodW1iXCIgcHJpem1TY3JvbGxiYXI9XCJ2ZXJ0aWNhbFwiIHByaXptVGhlbWU+PC9kaXY+XG4gIDwvZGl2PlxuICA8ZGl2XG4gICAgY2xhc3M9XCJiYXIgYmFyX2hvcml6b250YWxcIlxuICAgICpuZ0lmPVwiYmFyc1sxXVwiXG4gICAgW0Bwcml6bUZhZGVJbl09XCJhbmltYXRpb25cIlxuICAgIFtjbGFzcy5iYXJfaGFzLXZlcnRpY2FsXT1cImJhcnNbMF1cIlxuICAgIHByaXptU2Nyb2xsYmFyV3JhcHBlclxuICA+XG4gICAgPGRpdiBjbGFzcz1cInRodW1iXCIgcHJpem1TY3JvbGxiYXI9XCJob3Jpem9udGFsXCIgcHJpem1UaGVtZT48L2Rpdj5cbiAgPC9kaXY+XG48L25nLWNvbnRhaW5lcj5cbiJdfQ==